# [Goal] v0.1.0b1 リリース準備計画 (2026-01-30)

本計画書は、`gwexpy` の初公開ベータ版 (v0.1.0b1) リリースに向けた詳細な準備手順と、事前の検証結果をまとめたものです。

## ユーザー確認事項
>
> [!IMPORTANT]
>
> - **リリース日**: **未定 (TBD)** とします。
> - **PyPIアップロード**: まず TestPyPI へのテストアップロードを実施します。
> - **オプション依存関係**: `nds2-client` は PyPI に存在しません。ドキュメントにて Conda でのインストールを推奨する方針で進めます。

## 実施タスク詳細

### 1. パッケージングと公開準備

- **ツールの準備**:
  - `twine` が環境に不足しているためインストールします。
- **CHANGELOGの確定**:
  - `[Unreleased]` セクションを `[0.1.0b1] - <リリース日>` に更新します。
- **PyPIメタデータ検証**:
  - `twine check` で長文説明や classifier の妥当性を検証します。
  - TestPyPI へのアップロードと `pip install gwexpy` によるインストールテストを実施します。
- **オプション依存関係の確認 (済)**:
  - *事前の検証により、`gwexpy[all]` の定義とドキュメント方針（Conda使用）の整合性は確認済みです。*
- **パッケージ内容の最終チェック (済)**:
  - *事前の検証により、必須ファイル同梱とバージョン一致は確認済みです。*
- **リリースタグと公開**:
  - Gitタグ `v0.1.0b1` 作成、GitHubリリース発行、本番PyPI公開、ユーザ環境での利用検証を行います。

### 2. テストとCIの最終確認

- **テスト完遂の確認**:
  - GUI/非GUIテストの分離実行、DeprecationWarning等の不要警告がフィルタされていることを確認します（事前検証で収集は成功）。
- **型ヒント互換性修正 (Python 3.9) (要対応)**:
  - 以下のファイルの `X | None` 記法を `Optional[X]` へ修正します：
    - `gwexpy/gui/nds/cache.py`
    - `gwexpy/fitting/highlevel.py`
    - `gwexpy/timeseries/arima.py`
    - `gwexpy/timeseries/_signal.py`
    - `gwexpy/timeseries/utils.py`
  - 修正後、Python 3.9 環境でのテスト通過を確認します。
- **CI設定の見直し (一部済)**:
  - *GUIテスト環境 (`waitExposed`使用) は事前検証で適切であることを確認済みです。*
  - NDS接続テスト等に `pytest -m "not nds"` マーカーが正しく機能するか確認します。
- **ノートブック検証の対応**:
  - 高負荷なノートブック（例: `advanced_arima.ipynb`）のタイムアウト対策として、CIでの実行スキップまたは軽量化を検討・適用します。
- **テスト網羅率の向上**:
  - 特に `gwexpy/timeseries/_core.py`, `gwexpy/fields/demo.py` (現在0-10%台) について、基本的なユニットテストを追加し、正常動作を確認します。

### 3. ドキュメントとチュートリアルの仕上げ

- **「Coming Soon」表記の除去**:
  - Matrix系やノイズ分析系のチュートリアルへのリンクを整備します。
- **チュートリアル内容の整合性修正**:
  - 詳細な章番号・ステップ番号修正（Advanced ARIMA, TimeSeries等）。
- **未翻訳部分の対処**:
  - ScalarField (`signal_processing_scalarfield.ipynb`) 等の「Under translation」解消。
- **表示フォーマット調整**:
  - タイトル改行修正、レイアウト確認。
- **警告ログの非表示**:
  - Interopチュートリアル（MTH5連携等）での過剰なWARNINGログ抑制。
- **インストールガイド更新**:
  - `pip install gwexpy` 推奨手順への書き換え。
- **ビルドとリンクチェック**:
  - `sphinx-build -nW` および `linkcheck` の通過確認。

### 4. READMEとプロジェクト情報の確認

- **README更新**:
  - インストール手順の標準化、GitHub経由インストールの記述削除。
  - 最新機能（Pickle往復保証など）の記載確認。
- **メタデータ最終チェック**:
  - PyPI表示用メタデータ整合性確認。
- **CHANGELOGの確認**:
  - 内容の一致確認。

### 5. GUIとユーザー体験

- **未実装機能の明示**:
  - 「Reference」「Calibration」ボタンへのツールチップ追加または無効化確認。
- **E2E動作確認**:
  - インポート、GUI起動、ストリーミング操作の確認。
- **ユーザーフィードバック準備**:
  - Issues/Discussions有効化、連絡先の明記。

### 6. コード品質と構造

- **例外処理の是正**:
  - 広域例外および `except ...: pass` の確認。
- **型ヒントと静的解析**:
  - `mypy .` のエラー解消、`# type: ignore` の最小化。
- **GUIモジュール構造**:
  - エントリポイント `gwexpy.gui` の動作確認。

### 7. 依存関係と整理

- **依存関係の網羅**:
  - `dependencies` の過不足確認。
- **TODO/デッドコード整理**:
  - ソースコード内のTODO/FIXMEタグ確認、デッドコード排除。

## 事前検証レポート (Initial verification)

*実施日: 2026-01-30*

1. **PyPIメタデータ**: ツール(`twine`)未インストールのため検証未完了。追加タスクとしてインストールを設定。
2. **パッケージ内容**: Version一致(`0.1.0b1`)、必須ファイル(`LICENSE`, `py.typed`)の同梱を確認済み。
3. **テスト**: 2746件のテスト収集に成功。
4. **互換性(Py3.9)**: 指摘通り `| None` 記法を多数確認。修正計画を確定。
5. **GUIテスト**: `waitExposed` 等の使用により環境依存対策済みであることを確認。
6. **オプション依存関係**: `gwexpy[all]` に `nds2-client` が含まれていないことを確認（想定通り）。

## 使用モデルとリソース最適化 (Archive Plan Metadata)

- **推奨モデル**: `Claude Sonnet 3.5` (コーディング・ドキュメント修正のバランスが良い) または `Gemini 1.5 Pro` (大規模コンテキストでの整合性チェック)。
- **リソース管理**: 計画・検証段階では `Gemini 1.5 Pro` を使用し、トークン消費を抑えつつ正確性を担保した。実装フェーズでは `Claude Sonnet` 等の高速モデルへの切り替えを推奨。
