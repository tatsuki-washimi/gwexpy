# pyaggui 開発計画: LLMモデル推奨と工数見積もり

**作成日:** 2026-01-22  
**対象:** `pyaggui_development_plan.md` の実行プラン  
**目的:** 各フェーズに最適なLLMモデルの提案と、作業時間・クオータ消費の見積もり

---

## 1. フェーズ別モデル推奨

### Phase 1: コアロジックの検証と基盤強化 (1-2週間)

**主なタスク:**
- PSD/CSD 正規化の検証（数学的厳密性が必要）
- MeasurementState スキーマ定義（設計タスク）
- DTT XML 互換性実装（パース処理）

**推奨モデル:**
- **メインモデル**: `Claude Sonnet 4.5` (標準版)
  - **理由**: 数式検証とコード実装のバランスが良い。scipy との比較検証に最適。
  - **用途**: PSD正規化検証コードの実装、テストケース作成
- **サブモデル**: `Gemini 3 Flash`
  - **理由**: 高速な反復テストとドキュメント生成
  - **用途**: ノートブック作成、簡単なリファクタリング

**工数見積もり:**

| タスク | 推定時間 | クオータ消費 | 備考 |
|--------|----------|--------------|------|
| Task 1.1: PSD正規化検証 | 2-3時間 | Medium | 数式検証 + pytest実装 |
| Task 1.2: MeasurementState設計 | 1-2時間 | Low-Medium | Pydantic モデル定義 |
| Task 1.3: DTT XML互換性 | 2-3時間 | Medium | dttxml連携、テスト |
| **Phase 1 合計** | **5-8時間** | **Medium** | |

**懸念事項:**
- DTT の実データが無い場合、検証が困難（→ 合成データで代替）

---

### Phase 2: Swept Sine (伝達関数測定) の実装 (3-4週間)

**主なタスク:**
- SweptSineMeasurement クラス設計（アーキテクチャ設計）
- 同期検波 (Lock-in Detection) アルゴリズム実装（信号処理）
- GUI 統合（PySide6/Qt）

**推奨モデル:**
- **メインモデル**: `Claude Opus 4.5 (Thinking)`
  - **理由**: 複雑な信号処理アルゴリズムと物理的整合性の検証に最適。Thinking版で論理構築の透明性を確保。
  - **用途**: SweptSine アルゴリズム実装、数値安定性の検証
- **サブモデル**: `Gemini 3 Flash`
  - **理由**: GUI部分の高速実装
  - **用途**: Qt ウィジェット追加、ボタン配置など

**工数見積もり:**

| タスク | 推定時間 | クオータ消費 | 備考 |
|--------|----------|--------------|------|
| Task 2.1: Swept Sine実装 | 6-10時間 | High | アルゴリズム + テスト |
| Task 2.2: GUI統合 | 3-5時間 | Medium | Qt実装、イベント処理 |
| **Phase 2 合計** | **9-15時間** | **High** | |

**懸念事項:**
- シミュレーション環境での検証のみ。実測定データとの比較ができない可能性。

---

### Phase 3: 高度な解析機能とデータ処理 (2-3週間)

**主なタスク:**
- Zoom FFT 実装（ヘテロダイン変換 + デシメーション）
- 単位変換ロジック拡充
- バーストノイズ測定

**推奨モデル:**
- **メインモデル**: `Claude Sonnet 4.5 (Thinking)`
  - **理由**: Zoom FFT の複雑な数値処理に対応。Thinking版で周波数シフトとデシメーションのロジック構築。
  - **用途**: Zoom FFT 実装、単位変換マトリクス設計
- **サブモデル**: `Gemini 3 Flash`
  - **理由**: テストケースや簡単なリファクタリング
  - **用途**: pytest追加、ドキュメント更新

**工数見積もり:**

| タスク | 推定時間 | クオータ消費 | 備考 |
|--------|----------|--------------|------|
| Task 3.1: Zoom FFT | 4-6時間 | Medium-High | 複雑なDSP処理 |
| Task 3.2: 単位変換 | 2-3時間 | Low-Medium | 変換テーブル実装 |
| Task 3.3: バーストノイズ | 3-4時間 | Medium | ゲーティングロジック |
| **Phase 3 合計** | **9-13時間** | **Medium-High** | |

**懸念事項:**
- Zoom FFT のエッジケース（境界処理）で数値誤差が発生する可能性。

---

### Phase 4: バックエンド統合と高度なシミュレーション (4週間〜)

**主なタスク:**
- NDS2 リアルタイムストリーミング堅牢化（非同期処理、エラーハンドリング）
- AWG シミュレーション拡張（任意波形、フィルタ適用）
- Foton フィルタファイル連携

**推奨モデル:**
- **メインモデル**: `Gemini 3 Pro (High)` または `Claude Sonnet 4.5`
  - **理由**: 長時間の非同期処理ロジックやファイルパース処理に最適。
  - **用途**: NDS2 クライアント再設計、Foton パーサー実装
- **サブモデル**: `Gemini 3 Flash`
  - **理由**: GUI 改良と可視化機能追加
  - **用途**: 波形エクスポート UI、フィルタ適用前後の比較表示

**工数見積もり:**

| タスク | 推定時間 | クオータ消費 | 備考 |
|--------|----------|--------------|------|
| Task 4.1: NDS2堅牢化 | 6-8時間 | Medium-High | 非同期処理、再接続ロジック |
| Task 4.2: AWGシミュレーション | 4-6時間 | Medium | 波形生成・エクスポート |
| Task 4.3: Foton連携 | 3-5時間 | Medium | テキストパース、SOS適用 |
| **Phase 4 合計** | **13-19時間** | **Medium-High** | |

**懸念事項:**
- NDS2 サーバーの実環境テストが必要。シミュレーションのみでは不十分な可能性。

---

## 2. 全体サマリー

### 総工数見積もり

| Phase | 推定時間 | クオータ消費 | 推奨メインモデル |
|-------|----------|--------------|------------------|
| Phase 1 | 5-8時間 | Medium | Claude Sonnet 4.5 |
| Phase 2 | 9-15時間 | High | Claude Opus 4.5 (Thinking) |
| Phase 3 | 9-13時間 | Medium-High | Claude Sonnet 4.5 (Thinking) |
| Phase 4 | 13-19時間 | Medium-High | Gemini 3 Pro (High) |
| **合計** | **36-55時間** | **High** | |

### モデル使用時間の配分（推奨）

```
Claude Opus 4.5 (Thinking):  9-15時間 (Phase 2専用)
Claude Sonnet 4.5:          14-21時間 (Phase 1, 3)
Gemini 3 Pro (High):        13-19時間 (Phase 4)
Gemini 3 Flash:             補助的に使用 (ドキュメント、簡単な修正)
```

### クオータ管理戦略

1. **Phase 2 (Swept Sine) は最もクオータを消費**
   - 可能であれば、Phase 1で基盤を固めてから一気に実装する。
   - 中断・再開が必要な場合は、詳細な実装メモを残す。

2. **Gemini Flash を積極活用**
   - テストコード生成、ドキュメント更新などの定型作業は Flash で高速化。
   - クオータ節約と並行して作業効率も向上。

3. **段階的実装の推奨**
   - Phase 2, 3 は一度に全機能を実装せず、最小機能版 (MVP) を先に完成させる。
   - 動作確認後に拡張する戦略でリスクを低減。

---

## 3. コストパフォーマンス評価

### ROI (投資対効果) 分析

**投資:**
- LLM クオータ: High (特に Phase 2)
- 作業時間: 36-55時間（人間単独なら 200-300時間相当）

**リターン:**
- DTT 互換ツールの完成 → LIGO/KAGRA での診断業務効率化
- Python ベースのモダンなUI → 保守性向上、新機能追加が容易
- 安全なシミュレーション環境 → 実機リスクなしでの検証

**結論:**
- **投資価値: 極めて高い**
- LLM を活用することで、人手作業の約 1/5 の時間で同等品質のツールを開発可能。

---

## 4. リスクとその軽減策

### リスク 1: DTT 実データが無く検証不十分

**軽減策:**
- 合成データ（既知のスペクトルを持つ信号）で代替検証
- DTT XML サンプルデータを探索（過去の測定記録など）

### リスク 2: Swept Sine 実装の複雑さでクオータ超過

**軽減策:**
- Phase 2 を細分化（2.1a シミュレーション版, 2.1b GUI統合）
- 各サブタスクごとに検証・コミットして進捗を可視化

### リスク 3: NDS2 実環境でのテスト不能

**軽減策:**
- モックサーバーでの動作確認を優先
- 実環境テストは別途スケジュール

---

## 5. 推奨される次のアクション

### 即座に開始可能なタスク (Phase 1)

1. **Task 1.1: PSD正規化検証ノートブック作成**
   - **推奨モデル**: `Claude Sonnet 4.5`
   - **推定時間**: 1-2時間
   - **目的**: scipy と DTT の窓関数正規化の違いを定量化

2. **Task 1.2: MeasurementState 設計**
   - **推奨モデル**: `Claude Sonnet 4.5`
   - **推定時間**: 1時間
   - **目的**: データクラスの定義と JSON シリアライズ実装

### 開始の判断基準

- **クオータに余裕がある場合**: Phase 1 全体を一気に実施
- **クオータが限られている場合**: Task 1.1 のみ実施し、結果を確認してから次へ

どのタスクから着手しますか？
