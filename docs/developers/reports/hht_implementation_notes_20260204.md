# Hilbert-Huang Transform (HHT) 実装・使用上の注意点

提供された資料（笹岡氏、酒井氏の修士論文、PRD論文、武田氏の資料等）に基づき、HHTを重力波データ解析に適用する際の実装上の詳細と使用上の注意点をまとめました。

## 1. アルゴリズム実装時のパラメータ設定

### EMD (Empirical Mode Decomposition)

- **停止条件 (Stoppage Criterion)**: Siftingプロセス（包絡線抽出の反復）の停止には、Cauchy型の収束判定を用いる。
  - 判定値 $\epsilon$ は通常 **0.2 〜 0.3** が推奨される。
- **スプライン補間**: 包絡線（Upper/Lower Envelopes）の生成には **三次スプライン (Cubic Spline)** を用いる。端点での振る舞いが全体の分解に影響するため、端点条件（Natural, Fixed-slope等）の選択が重要。

### EEMD / CEEMD (Ensemble EMD / Complementary EEMD)

- **ノイズ強度**: 元の信号の標準偏差に対して **0.1 〜 0.2倍** の白色雑音を加算するのが標準的。
- **アンサンブル回数 ($N$)**: 分解後の残留ノイズ（Residue）は $1/\sqrt{N}$ に比例して減少する。
  - 重力波バースト解析のような高精度が求められるケースでは **100回以上** の試行が一般的。
- **CEEMDの活用**: 計算コスト削減と残留ノイズ低減のため、正負のペアでノイズを加える **Complementary (CEEMD)** 方式が推奨される（武田氏の資料等でも言及）。

---

## 2. ヒルベルト・スペクトル（瞬時解析）の注意点

### 瞬時周波数 (IF) の算出

- **定義**: 位相 $\theta(t)$ の時間微分 $f(t) = \frac{1}{2\pi} \frac{d\theta(t)}{dt}$。
- **実装上の工夫**:
  - デジタルデータでは直接微分によりノイズが強調されやすいため、位相のアンラップ（Unwrapping）後の平滑化が必要な場合がある。
  - **Hilbert分析の限界**: IFが負になる場合や急激な跳躍がある場合、そのIMFは「Mono-component（単一成分）」の性質を十分に満たしていない可能性がある。

### ビン詰めとスペクトル生成

- **HMS (Hilbert-Huang Spectrogram)**: IFとIA（瞬時振幅）を時間-周波数平面にビン詰め（Binning）する。IAの二乗（エネルギー）を重みとして集計するのが一般的。
- **Stacking HMS (重ね合わせ)**: 1回のHHTでは抽出できない微弱な信号トラックを捉えるため、異なるパラメータや雑音サンプルを用いた複数の HMS を重ね合わせる手法（Stacking）が提示されている（Sakai et al. 2017, HHT_PRD等）。

---

## 3. 使用上の注意点と制限事項

### 端点効果 (Edge Effects)

- スプライン補間に起因し、信号の開始・終了付近（端点）で包絡線が大きく揺らぐ現象。
- **対策**:
  - 信号の端を窓関数で絞る。
  - 信号の両端にデータをパディングする、または鏡像拡張（Mirroring）を行う。
  - 解析結果の端（例：数サイクル分）は信頼しない。

### モードミキシング (Mode Mixing)

- 本来単一の物理成分であるべき信号が複数のIMFに分かれたり、逆に異なる成分が1つのIMFに混ざったりする現象。
- EEMDはこの問題を緩和するが、完全に解消されるわけではない。特に重力波の合体フェーズ（Chirp信号）のように周波数が急激に変化する場合、複数のIMFにまたがって信号が抽出される（Spread）ことがある。

### データ品質の影響

- 高周波ノイズが混入している場合、第1, 2 IMF（高周波成分）がノイズで埋め尽くされ、信号の抽出が困難になる。
- プリフィルタリング（バンドパス等）を適切に行うことで、EMDの収束性と低次IMFの視認性が向上する。

### 物理的解釈の妥当性

- HHTは非線形・非定常データに強いが、得られた各IMFが必ずしも「独立した物理現象」に対応するとは限らない。特にモードミキシングが生じている場合は注意が必要。
