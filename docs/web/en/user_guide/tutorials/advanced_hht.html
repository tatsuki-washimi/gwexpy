

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hilbert-Huang Transform (HHT) Analysis Tutorial &mdash; GWexpy Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Time-Frequency Analysis Methods: Comprehensive Comparison" href="time_frequency_analysis_comparison.html" />
    <link rel="prev" title="Peak Detection" href="advanced_peak_detection.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            GWexpy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">GWexpy Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../index.html#choose-your-guide">Choose Your Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#visual-examples">Visual Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#example-gallery">Example Gallery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#learning-path-by-user-level">Learning Path by User Level</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html#main-documentation">Main Documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="index.html#i-core-data-structures">I. Core Data Structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#ii-multi-channel-matrix-containers">II. Multi-channel &amp; Matrix Containers</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#iii-high-dimensional-fields">III. High-dimensional Fields</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html#iv-advanced-signal-processing">IV. Advanced Signal Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#v-specialized-tools">V. Specialized Tools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/index.html">Case Studies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../migration_fftlength.html">Migration Guide: nperseg/noverlap → fftlength/overlap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerical_stability.html">Numerical Stability and Precision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scalarfield_slicing.html">ScalarField Slicing Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validated_algorithms.html">Validated Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validated_algorithms.html#assumptions-and-conventions">Assumptions and Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/index.html">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#next-steps">Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#language">Language</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ja/index.html">GWexpy ドキュメントへようこそ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">GWexpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">GWexpy Documentation</a></li>
          <li class="breadcrumb-item"><a href="index.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Hilbert-Huang Transform (HHT) Analysis Tutorial</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/tatsuki-washimi/gwexpy/blob/main/docs/web/en/user_guide/tutorials/advanced_hht.ipynb" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p>This page was generated from a Jupyter Notebook.
<a class="reference external" href="https://github.com/tatsuki-washimi/gwexpy/raw/main/docs/web/en/user_guide/tutorials/advanced_hht.ipynb">Download the notebook (.ipynb)</a></p>
</div>
<section id="Hilbert-Huang-Transform-(HHT)-Analysis-Tutorial">
<h1>Hilbert-Huang Transform (HHT) Analysis Tutorial<a class="headerlink" href="#Hilbert-Huang-Transform-(HHT)-Analysis-Tutorial" title="Link to this heading"></a></h1>
<p>This tutorial explains the procedure for <strong>Hilbert-Huang Transform (HHT)</strong> analysis using <strong>gwexpy</strong>. HHT is well-suited for analyzing nonlinear and non-stationary signals, and is a powerful method for extracting local frequency variations (instantaneous frequency) that cannot be captured by traditional Fourier or wavelet transforms. The sample code in this tutorial uses <code class="docutils literal notranslate"><span class="pre">TimeSeries.hht()</span></code>.</p>
<p>HHT consists of two main steps:</p>
<ol class="arabic simple">
<li><p><strong>Empirical Mode Decomposition (EMD)</strong>: Decomposes the signal into Intrinsic Mode Functions (IMFs).</p></li>
<li><p><strong>Hilbert Spectral Analysis</strong>: Applies the Hilbert transform to each IMF to calculate instantaneous amplitude and instantaneous frequency.</p></li>
</ol>
<p><strong>Note</strong>: To use this feature, the <code class="docutils literal notranslate"><span class="pre">PyEMD</span></code> (EMD-signal) package must be installed.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>EMD-signal
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeries</span>

<span class="c1"># Check PyEMD installation</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">PyEMD</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PyEMD is installed and ready.&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
        <span class="s2">&quot;This tutorial requires &#39;PyEMD&#39; (EMD-signal). Please run: pip install EMD-signal&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PyEMD is installed and ready.
</pre></div></div>
</div>
<section id="1.-Theoretical-Background-and-Advantages-of-HHT">
<h2>1. Theoretical Background and Advantages of HHT<a class="headerlink" href="#1.-Theoretical-Background-and-Advantages-of-HHT" title="Link to this heading"></a></h2>
<section id="What-is-HHT-(Hilbert-Huang-Transform)?">
<h3>What is HHT (Hilbert-Huang Transform)?<a class="headerlink" href="#What-is-HHT-(Hilbert-Huang-Transform)?" title="Link to this heading"></a></h3>
<p>HHT is a powerful method for analyzing nonlinear and non-stationary signal data. It consists of two main processes:</p>
<ol class="arabic simple">
<li><p><strong>EMD (Empirical Mode Decomposition)</strong>: Decomposes the original signal into a sum of Intrinsic Mode Functions (IMFs) with different frequency scales.</p></li>
<li><p><strong>HSA (Hilbert Spectral Analysis)</strong>: Applies the Hilbert transform to each IMF to calculate <strong>Instantaneous Frequency</strong> and instantaneous amplitude.</p></li>
</ol>
</section>
<section id="Differences-from-Traditional-STFT">
<h3>Differences from Traditional STFT<a class="headerlink" href="#Differences-from-Traditional-STFT" title="Link to this heading"></a></h3>
<p>Short-Time Fourier Transform (STFT) and wavelet transforms have a trade-off between time resolution and frequency resolution (limited by the uncertainty principle). In contrast, HHT adaptively generates basis functions based on local time scales, so it is not subject to this limitation and can achieve <strong>high time and frequency resolution</strong> simultaneously.</p>
</section>
<section id="EEMD-(Ensemble-EMD)">
<h3>EEMD (Ensemble EMD)<a class="headerlink" href="#EEMD-(Ensemble-EMD)" title="Link to this heading"></a></h3>
<p>In standard EMD, “mode mixing” can occur where different frequency components are mixed within a single IMF due to intermittent signals or noise. To solve this, <strong>EEMD (Ensemble EMD)</strong> has been proposed.</p>
<ul class="simple">
<li><p>Generate multiple ensemble members by adding white noise to the original signal.</p></li>
<li><p>Perform EMD on each signal.</p></li>
<li><p>Take the ensemble average of the resulting IMFs to cancel out the noise and stably extract physically meaningful modes.</p></li>
</ul>
</section>
</section>
<section id="2.-Simulation:-Reproducing-SASI-Modes">
<h2>2. Simulation: Reproducing SASI Modes<a class="headerlink" href="#2.-Simulation:-Reproducing-SASI-Modes" title="Link to this heading"></a></h2>
<p>In gravitational wave analysis of core-collapse supernovae (CCSN), the instability called <strong>SASI (Standing Accretion Shock Instability)</strong> is an important observation target. Here, we create a <strong>Sine-Gaussian</strong> signal simulating gravitational waves from SASI and analyze it (Reference: Takeda et al. 2021).</p>
<p>The Sine-Gaussian signal is expressed by the following equation:</p>
<div class="math notranslate nohighlight">
\[h(t) = A \exp\left( - \left( \frac{2\pi (t - t_0)}{t_{\text{width}}} \right)^2 \right) \sin(2\pi f_0 t)\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeries</span>


<span class="k">def</span><span class="w"> </span><span class="nf">sine_gaussian</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t_width</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="n">exponent</span> <span class="o">=</span> <span class="o">-</span><span class="p">(((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t0</span><span class="p">))</span> <span class="o">/</span> <span class="n">t_width</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">exponent</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>


<span class="c1"># Parameter settings (mimicking SASI mode)</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># seconds</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">4096</span>  <span class="c1"># sampling rate</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="n">fs</span><span class="p">))</span>

<span class="c1"># Generate signal</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># peak time</span>
<span class="n">t_width</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># width</span>
<span class="n">f0</span> <span class="o">=</span> <span class="mf">130.0</span>  <span class="c1"># frequency (Hz)</span>
<span class="n">clean_signal</span> <span class="o">=</span> <span class="n">sine_gaussian</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t_width</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="mf">1e-21</span><span class="p">)</span>

<span class="c1"># Add noise</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">noise_amp</span> <span class="o">=</span> <span class="mf">0.1e-21</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">noise_amp</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">clean_signal</span> <span class="o">+</span> <span class="n">noise</span>

<span class="c1"># Create TimeSeries object</span>
<span class="n">ts_data</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Simulated SASI Signal&quot;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;strain&quot;</span>
<span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ts_data</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Noisy Signal&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">clean_signal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Target Signal (SASI)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Strain&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Simulated SASI Gravitational Wave Signal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/web_en_user_guide_tutorials_advanced_hht_4_0.png" src="../../../../_images/web_en_user_guide_tutorials_advanced_hht_4_0.png" />
</div>
</div>
</section>
<section id="3.-Comparative-Analysis:-STFT-vs-HHT">
<h2>3. Comparative Analysis: STFT vs HHT<a class="headerlink" href="#3.-Comparative-Analysis:-STFT-vs-HHT" title="Link to this heading"></a></h2>
<p>We apply STFT (spectrogram) and HHT (Hilbert spectrum) to the same signal and compare their resolution differences.</p>
<p><strong>Note</strong>: In the following results, STFT may appear more robust to noise and the signal may look cleaner. This is because standard EMD is susceptible to noise and causes “mode mixing.” This problem is dramatically improved by using <strong>EEMD</strong>, which we will introduce in the next section, but let’s first check the basic behavior of HHT.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --- 1. STFT (Spectrogram) using gwexpy API ---</span>
<span class="c1"># Convert sample counts to time-based parameters for gwexpy API:</span>
<span class="c1"># nperseg=128 samples → fftlength = 128/fs seconds</span>
<span class="c1"># noverlap=120 samples → overlap = 120/fs seconds</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">ts_data</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="n">fftlength</span><span class="o">=</span><span class="mi">128</span><span class="o">/</span><span class="n">fs</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">120</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">f_stft</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">value</span>
<span class="n">t_stft</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">value</span>
<span class="n">Sxx</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">value</span>

<span class="c1"># --- 2. HHT (EMD + Hilbert) ---</span>
<span class="c1"># Important: EMD has numerical tolerance, so it may not decompose well for very small amplitudes (e.g., 1e-21 for GW).</span>
<span class="c1"># Therefore, we normalize the data first, then scale back the results.</span>
<span class="n">data_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ts_data</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">ts_norm</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">(</span>
    <span class="n">ts_data</span><span class="o">.</span><span class="n">value</span> <span class="o">/</span> <span class="n">data_std</span><span class="p">,</span>
    <span class="n">t0</span><span class="o">=</span><span class="n">ts_data</span><span class="o">.</span><span class="n">t0</span><span class="p">,</span>
    <span class="n">sample_rate</span><span class="o">=</span><span class="n">ts_data</span><span class="o">.</span><span class="n">sample_rate</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Normalized SASI Signal&quot;</span><span class="p">,</span>
    <span class="n">unit</span><span class="o">=</span><span class="n">ts_data</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">hht_result</span> <span class="o">=</span> <span class="n">ts_norm</span><span class="o">.</span><span class="n">hht</span><span class="p">(</span>
    <span class="n">emd_method</span><span class="o">=</span><span class="s2">&quot;emd&quot;</span><span class="p">,</span>
    <span class="n">emd_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;sift_max_iter&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">&quot;stopping_criterion&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">hilbert_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;pad&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">&quot;if_smooth&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">output</span><span class="o">=</span><span class="s2">&quot;dict&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">imfs</span> <span class="o">=</span> <span class="n">hht_result</span><span class="p">[</span><span class="s2">&quot;imfs&quot;</span><span class="p">]</span>
<span class="n">if_dict</span> <span class="o">=</span> <span class="n">hht_result</span><span class="p">[</span><span class="s2">&quot;if&quot;</span><span class="p">]</span>
<span class="n">ia_dict</span> <span class="o">=</span> <span class="n">hht_result</span><span class="p">[</span><span class="s2">&quot;ia&quot;</span><span class="p">]</span>
<span class="n">n_imfs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">imfs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extracted </span><span class="si">{</span><span class="n">n_imfs</span><span class="si">}</span><span class="s2"> IMFs from normalized data.&quot;</span><span class="p">)</span>

<span class="c1"># --- Plot ---</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># STFT</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t_stft</span><span class="p">,</span> <span class="n">f_stft</span><span class="p">,</span> <span class="n">Sxx</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;gouraud&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency [Hz]&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [sec]&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Short-Time Fourier Transform (STFT)&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Power&quot;</span><span class="p">)</span>

<span class="c1"># HHT Plot</span>
<span class="c1"># Filter out low-amplitude points (noise) for visibility</span>
<span class="n">amp_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ia_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">imfs</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
<span class="n">max_amp</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">amp_list</span><span class="p">)</span> <span class="o">*</span> <span class="n">data_std</span><span class="p">)</span> <span class="k">if</span> <span class="n">amp_list</span> <span class="k">else</span> <span class="mf">1.0</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="n">max_amp</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># Display only points above 10% of max amplitude</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">imfs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">t_vals</span> <span class="o">=</span> <span class="n">if_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">value</span>
    <span class="n">inst_freq</span> <span class="o">=</span> <span class="n">if_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
    <span class="n">inst_amp</span> <span class="o">=</span> <span class="n">ia_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">data_std</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">inst_amp</span> <span class="o">&gt;</span> <span class="n">threshold</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">mask</span><span class="p">):</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">t_vals</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span>
            <span class="n">inst_freq</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span>
            <span class="n">c</span><span class="o">=</span><span class="n">inst_amp</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span>
            <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">max_amp</span><span class="p">,</span>
        <span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Instantaneous Frequency [Hz]&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [sec]&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Hilbert-Huang Transform (HHT)&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Instantaneous Amplitude&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Extracted 9 IMFs from normalized data.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/web_en_user_guide_tutorials_advanced_hht_6_1.png" src="../../../../_images/web_en_user_guide_tutorials_advanced_hht_6_1.png" />
</div>
</div>
</section>
<section id="4.-Application:-Mode-Extraction-and-Parameter-Estimation-with-EEMD">
<h2>4. Application: Mode Extraction and Parameter Estimation with EEMD<a class="headerlink" href="#4.-Application:-Mode-Extraction-and-Parameter-Estimation-with-EEMD" title="Link to this heading"></a></h2>
<section id="Applying-EEMD">
<h3>Applying EEMD<a class="headerlink" href="#Applying-EEMD" title="Link to this heading"></a></h3>
<p>In the simple EMD results above, the frequency may oscillate due to the influence of noise, or the original 130Hz signal may be split into multiple IMFs (mode mixing). Using <strong>EEMD (Ensemble EMD)</strong> can improve this.</p>
<blockquote>
<div><p>In <strong>Sasaoka et al. (2024)</strong>, it was shown that in gravitational wave analysis from CCSN, using EEMD (or CEEMD) can accurately extract the oscillation modes of the proto-neutron star (PNS) and estimate PNS physical quantities (mass-to-radius ratio <span class="math notranslate nohighlight">\(M/R^2\)</span>) from the frequency evolution.</p>
</div></blockquote>
<p>The following code is an example of running EEMD using gwexpy’s <code class="docutils literal notranslate"><span class="pre">TimeSeries.hht()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run EEMD (gwexpy API)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running EEMD on normalized data via TimeSeries.hht()...&quot;</span><span class="p">)</span>
<span class="n">eemd_result</span> <span class="o">=</span> <span class="n">ts_norm</span><span class="o">.</span><span class="n">hht</span><span class="p">(</span>
    <span class="n">emd_method</span><span class="o">=</span><span class="s2">&quot;eemd&quot;</span><span class="p">,</span>
    <span class="n">emd_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;eemd_trials&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s2">&quot;eemd_noise_std&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
        <span class="s2">&quot;random_state&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
        <span class="s2">&quot;sift_max_iter&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">&quot;stopping_criterion&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">hilbert_kwargs</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;pad&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">&quot;if_smooth&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">output</span><span class="o">=</span><span class="s2">&quot;dict&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">eimfs</span> <span class="o">=</span> <span class="n">eemd_result</span><span class="p">[</span><span class="s2">&quot;imfs&quot;</span><span class="p">]</span>
<span class="n">n_eimfs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">eimfs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EEMD completed. Extracted </span><span class="si">{</span><span class="n">n_eimfs</span><span class="si">}</span><span class="s2"> IMFs.&quot;</span><span class="p">)</span>

<span class="c1"># Visualize all IMFs</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n_eimfs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n_eimfs</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">n_eimfs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eimfs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">imf_ts</span> <span class="o">=</span> <span class="n">eimfs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">imf_ts</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">imf_ts</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">data_std</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMF </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n_eimfs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [s]&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;EEMD Decomposed Modes&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Running EEMD on normalized data...
EEMD completed. Extracted 9 IMFs.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/web_en_user_guide_tutorials_advanced_hht_8_1.png" src="../../../../_images/web_en_user_guide_tutorials_advanced_hht_8_1.png" />
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="advanced_peak_detection.html" class="btn btn-neutral float-left" title="Peak Detection" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="time_frequency_analysis_comparison.html" class="btn btn-neutral float-right" title="Time-Frequency Analysis Methods: Comprehensive Comparison" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, GWexpy contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>