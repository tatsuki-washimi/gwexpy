

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Time-Frequency Analysis Methods: Comprehensive Comparison &mdash; GWexpy Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Time-Frequency Methods: Comparison and Selection Guide" href="time_frequency_comparison.html" />
    <link rel="prev" title="Hilbert-Huang Transform (HHT) 解析チュートリアル" href="advanced_hht.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            GWexpy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">GWexpy Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../index.html#choose-your-guide">Choose Your Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#visual-examples">Visual Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#example-gallery">Example Gallery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#learning-path-by-user-level">Learning Path by User Level</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html#main-documentation">Main Documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="index.html#i-core-data-structures">I. Core Data Structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#ii-multi-channel-matrix-containers">II. Multi-channel &amp; Matrix Containers</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#iii-high-dimensional-fields">III. High-dimensional Fields</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html#iv-advanced-signal-processing">IV. Advanced Signal Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#v-specialized-tools">V. Specialized Tools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../migration_fftlength.html">Migration Guide: nperseg/noverlap → fftlength/overlap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerical_stability.html">Numerical Stability and Precision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scalarfield_slicing.html">ScalarField Slicing Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validated_algorithms.html">Validated Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../validated_algorithms.html#assumptions-and-conventions">Assumptions and Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="case_ml_preprocessing.html">Machine Learning Preprocessing Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/index.html">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reference/index.html">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#next-steps">Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#language">Language</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../ja/index.html">GWexpy ドキュメントへようこそ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">GWexpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">GWexpy Documentation</a></li>
          <li class="breadcrumb-item"><a href="index.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Time-Frequency Analysis Methods: Comprehensive Comparison</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/tatsuki-washimi/gwexpy/blob/main/docs/web/en/user_guide/tutorials/time_frequency_analysis_comparison.ipynb" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p>This page was generated from a Jupyter Notebook.
<a class="reference external" href="https://github.com/tatsuki-washimi/gwexpy/raw/main/docs/web/en/user_guide/tutorials/time_frequency_analysis_comparison.ipynb">Download the notebook (.ipynb)</a></p>
</div>
<section id="Time-Frequency-Analysis-Methods:-Comprehensive-Comparison">
<h1>Time-Frequency Analysis Methods: Comprehensive Comparison<a class="headerlink" href="#Time-Frequency-Analysis-Methods:-Comprehensive-Comparison" title="Link to this heading"></a></h1>
<section id="1.-Introduction">
<h2>1. Introduction<a class="headerlink" href="#1.-Introduction" title="Link to this heading"></a></h2>
<section id="Purpose">
<h3>Purpose<a class="headerlink" href="#Purpose" title="Link to this heading"></a></h3>
<p>This notebook demonstrates when and why to choose specific time-frequency analysis methods for gravitational wave data. We use <strong>gwpy’s STFT and Q-transform as baselines</strong>, then show scenarios where gwexpy’s advanced methods (Wavelet, HHT, STLT, Cepstrum, DCT) clearly outperform.</p>
</section>
<section id="Key-Principle">
<h3>Key Principle<a class="headerlink" href="#Key-Principle" title="Link to this heading"></a></h3>
<p><strong>There is no universal “best” method.</strong> Each technique excels in specific scenarios:</p>
<ul class="simple">
<li><p><strong>STFT/Spectrogram</strong>: General-purpose, well-established</p></li>
<li><p><strong>Q-transform</strong>: Transients with scale-dependent resolution</p></li>
<li><p><strong>Wavelet (CWT)</strong>: Scale-varying chirps and multi-scale features</p></li>
<li><p><strong>HHT</strong>: Instantaneous frequency for non-stationary AM/FM signals</p></li>
<li><p><strong>STLT</strong>: Damped oscillations with decay rate information</p></li>
<li><p><strong>Cepstrum</strong>: Echo detection and periodicity in spectrum</p></li>
<li><p><strong>DCT</strong>: Signal compression and smooth feature extraction</p></li>
</ul>
</section>
<section id="What-You'll-Learn">
<h3>What You’ll Learn<a class="headerlink" href="#What-You'll-Learn" title="Link to this heading"></a></h3>
<p>For each method, we show:</p>
<ol class="arabic simple">
<li><p><strong>Signal design</strong>: Why this signal challenges STFT/Q</p></li>
<li><p><strong>Baseline limitations</strong>: What STFT/Q cannot show clearly</p></li>
<li><p><strong>Target method results</strong>: Clear visual advantage</p></li>
<li><p><strong>Takeaway</strong>: When to use this method</p></li>
</ol>
</section>
</section>
<section id="2.-Common-Setup">
<h2>2. Common Setup<a class="headerlink" href="#2.-Common-Setup" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Suppress warnings for clean output</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Standard imports</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span> <span class="k">as</span> <span class="n">scipy_signal</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pywt</span>

<span class="c1"># gwpy for baseline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gwpy.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeries</span> <span class="k">as</span> <span class="n">GWpyTimeSeries</span>

<span class="c1"># gwexpy for advanced methods</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeries</span>

<span class="c1"># Common parameters</span>
<span class="n">SAMPLE_RATE</span> <span class="o">=</span> <span class="mi">2048</span>  <span class="c1"># Hz</span>
<span class="n">DURATION</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c1"># seconds</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Plotting configuration</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.grid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;grid.alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setup complete: </span><span class="si">{</span><span class="n">SAMPLE_RATE</span><span class="si">}</span><span class="s2"> Hz, </span><span class="si">{</span><span class="n">DURATION</span><span class="si">}</span><span class="s2">s duration&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[1]</span><span class="ansi-green-fg">, line 9</span>
<span class="ansi-green-fg">      7</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-blue-intense-fg ansi-bold">matplotlib</span><span class="ansi-blue-intense-fg ansi-bold">.</span><span class="ansi-blue-intense-fg ansi-bold">pyplot</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-bold" style="color: rgb(0,135,0)">as</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-blue-intense-fg ansi-bold">plt</span>
<span class="ansi-green-fg">      8</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-blue-intense-fg ansi-bold">scipy</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-bold" style="color: rgb(0,135,0)">import</span> signal <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> scipy_signal
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">9</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-blue-intense-fg ansi-bold">pywt</span>
<span class="ansi-green-fg">     11</span> <span style="color: rgb(95,135,135)"># gwpy for baseline</span>
<span class="ansi-green-fg">     12</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-blue-intense-fg ansi-bold">gwpy</span><span class="ansi-blue-intense-fg ansi-bold">.</span><span class="ansi-blue-intense-fg ansi-bold">timeseries</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-bold" style="color: rgb(0,135,0)">import</span> TimeSeries <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> GWpyTimeSeries

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;pywt&#39;
</pre></div></div>
</div>
</section>
<section id="3.-Benchmark-Signal:-Multi-Component-Test">
<h2>3. Benchmark Signal: Multi-Component Test<a class="headerlink" href="#3.-Benchmark-Signal:-Multi-Component-Test" title="Link to this heading"></a></h2>
<p>We create a composite signal containing:</p>
<ol class="arabic simple">
<li><p><strong>Quasi-stationary tones</strong> (50 Hz, 100 Hz)</p></li>
<li><p><strong>Linear chirp</strong> (20→150 Hz)</p></li>
<li><p><strong>Short high-Q burst</strong> (200 Hz, 0.1s duration)</p></li>
<li><p><strong>Exponential ringdown</strong> (120 Hz, τ=0.5s)</p></li>
<li><p><strong>Weak echo</strong> (50ms delay)</p></li>
<li><p><strong>Smooth trend</strong> (5 Hz modulation)</p></li>
</ol>
<p>This benchmark tests all methods’ strengths and weaknesses.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Time array</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DURATION</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">SAMPLE_RATE</span><span class="p">)</span>
<span class="n">nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># Initialize signal</span>
<span class="n">benchmark</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>

<span class="c1"># 1. Quasi-stationary tones</span>
<span class="n">benchmark</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">50</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">benchmark</span> <span class="o">+=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">100</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># 2. Linear chirp (t=2 to 5s)</span>
<span class="n">chirp_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">t_chirp</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">chirp_mask</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span>
<span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">150</span>
<span class="n">chirp_freq</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">+</span> <span class="p">(</span><span class="n">f1</span> <span class="o">-</span> <span class="n">f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">t_chirp</span> <span class="o">/</span> <span class="mi">3</span>
<span class="n">phase</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">f0</span><span class="o">*</span><span class="n">t_chirp</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">f1</span><span class="o">-</span><span class="n">f0</span><span class="p">)</span><span class="o">*</span><span class="n">t_chirp</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">benchmark</span><span class="p">[</span><span class="n">chirp_mask</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span>

<span class="c1"># 3. Short high-Q burst (t=6s, 0.1s duration)</span>
<span class="n">burst_center</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="n">burst_width</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">burst_window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="n">burst_center</span><span class="p">)</span><span class="o">/</span><span class="n">burst_width</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">benchmark</span> <span class="o">+=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">burst_window</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">200</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># 4. Exponential ringdown (t=3.5 to 7s)</span>
<span class="n">ringdown_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mf">3.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">t_ring</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">ringdown_mask</span><span class="p">]</span> <span class="o">-</span> <span class="mf">3.5</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># decay time</span>
<span class="n">benchmark</span><span class="p">[</span><span class="n">ringdown_mask</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_ring</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">120</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">ringdown_mask</span><span class="p">])</span>

<span class="c1"># 5. Weak echo (50ms delay, 30% amplitude)</span>
<span class="n">delay_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="n">SAMPLE_RATE</span><span class="p">)</span>  <span class="c1"># 50ms</span>
<span class="n">echo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>
<span class="n">echo</span><span class="p">[</span><span class="n">delay_samples</span><span class="p">:]</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">benchmark</span><span class="p">[:</span><span class="o">-</span><span class="n">delay_samples</span><span class="p">]</span>
<span class="n">benchmark</span> <span class="o">+=</span> <span class="n">echo</span>

<span class="c1"># 6. Smooth trend</span>
<span class="n">benchmark</span> <span class="o">+=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># Add white noise</span>
<span class="n">benchmark</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span>

<span class="c1"># Create TimeSeries objects</span>
<span class="n">ts_gwpy</span> <span class="o">=</span> <span class="n">GWpyTimeSeries</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">SAMPLE_RATE</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;strain&#39;</span><span class="p">)</span>
<span class="n">ts_gwexpy</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">SAMPLE_RATE</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;strain&#39;</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">benchmark</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Benchmark Signal: Multi-Component Time Series&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DURATION</span><span class="p">)</span>

<span class="c1"># Annotate components</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Chirp (20→150 Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Burst (200 Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ringdown (120 Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Benchmark signal contains:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Tones: 50 Hz, 100 Hz (stationary)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Chirp: 20→150 Hz (t=2-5s)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Burst: 200 Hz (t=6s, Q~20)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Ringdown: 120 Hz, τ=0.5s (t=3.5-7s)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Echo: 50ms delay, 30</span><span class="si">% a</span><span class="s2">mplitude&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Trend: 5 Hz modulation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[2]</span><span class="ansi-green-fg">, line 2</span>
<span class="ansi-green-fg">      1</span> <span style="color: rgb(95,135,135)"># Time array</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">2</span> t = np.arange(<span class="ansi-green-fg">0</span>, <span class="ansi-yellow-bg">DURATION</span>, <span class="ansi-green-fg">1</span>/SAMPLE_RATE)
<span class="ansi-green-fg">      3</span> nt = <span style="color: rgb(0,135,0)">len</span>(t)
<span class="ansi-green-fg">      5</span> <span style="color: rgb(95,135,135)"># Initialize signal</span>

<span class="ansi-red-fg">NameError</span>: name &#39;DURATION&#39; is not defined
</pre></div></div>
</div>
</section>
<section id="4.-Baseline-Analyses">
<h2>4. Baseline Analyses<a class="headerlink" href="#4.-Baseline-Analyses" title="Link to this heading"></a></h2>
<section id="4.1-STFT-(Spectrogram)---gwpy">
<h3>4.1 STFT (Spectrogram) - gwpy<a class="headerlink" href="#4.1-STFT-(Spectrogram)---gwpy" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute STFT spectrogram</span>
<span class="n">spec</span> <span class="o">=</span> <span class="n">ts_gwpy</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fftlength</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">spec</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">spec</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                   <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;STFT Spectrogram (window=0.5s) - Baseline Method 1&#39;</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Power Spectral Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;STFT Spectrogram shows:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Stationary tones clearly&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Chirp structure (somewhat smeared)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Burst location&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✗ Cannot resolve instantaneous frequency precisely&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✗ Decay rates invisible (only frequency visible)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✗ Echo structure not apparent&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[3]</span><span class="ansi-green-fg">, line 2</span>
<span class="ansi-green-fg">      1</span> <span style="color: rgb(95,135,135)"># Compute STFT spectrogram</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">2</span> spec = <span class="ansi-yellow-bg">ts_gwpy</span>.spectrogram(<span class="ansi-green-fg">0.5</span>, fftlength=<span class="ansi-green-fg">0.5</span>, overlap=<span class="ansi-green-fg">0.25</span>)
<span class="ansi-green-fg">      4</span> <span style="color: rgb(95,135,135)"># Plot</span>
<span class="ansi-green-fg">      5</span> fig, ax = plt.subplots(figsize=(<span class="ansi-green-fg">14</span>, <span class="ansi-green-fg">6</span>))

<span class="ansi-red-fg">NameError</span>: name &#39;ts_gwpy&#39; is not defined
</pre></div></div>
</div>
</section>
<section id="4.2-Q-transform---gwpy">
<h3>4.2 Q-transform - gwpy<a class="headerlink" href="#4.2-Q-transform---gwpy" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute Q-transform</span>
<span class="n">qgram</span> <span class="o">=</span> <span class="n">ts_gwpy</span><span class="o">.</span><span class="n">q_transform</span><span class="p">(</span><span class="n">qrange</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="n">frange</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">250</span><span class="p">))</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">qgram</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
               <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">qgram</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qgram</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                      <span class="n">qgram</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qgram</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>
               <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Q-transform (adaptive resolution) - Baseline Method 2&#39;</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Normalized Energy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q-transform shows:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Burst with excellent time resolution&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Chirp tracking better than STFT&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Adaptive resolution (high-f → good time res)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✗ Still cannot show instantaneous frequency as a curve&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✗ Decay rates invisible&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✗ Echo structure not apparent&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[4]</span><span class="ansi-green-fg">, line 2</span>
<span class="ansi-green-fg">      1</span> <span style="color: rgb(95,135,135)"># Compute Q-transform</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">2</span> qgram = <span class="ansi-yellow-bg">ts_gwpy</span>.q_transform(qrange=(<span class="ansi-green-fg">4</span>, <span class="ansi-green-fg">64</span>), frange=(<span class="ansi-green-fg">10</span>, <span class="ansi-green-fg">250</span>))
<span class="ansi-green-fg">      4</span> <span style="color: rgb(95,135,135)"># Plot</span>
<span class="ansi-green-fg">      5</span> fig, ax = plt.subplots(figsize=(<span class="ansi-green-fg">14</span>, <span class="ansi-green-fg">6</span>))

<span class="ansi-red-fg">NameError</span>: name &#39;ts_gwpy&#39; is not defined
</pre></div></div>
</div>
</section>
</section>
<section id="5.-%22Winning-Story%22-Scenarios">
<h2>5. “Winning Story” Scenarios<a class="headerlink" href="#5.-%22Winning-Story%22-Scenarios" title="Link to this heading"></a></h2>
</section>
<hr class="docutils" />
<section id="5.1-Wavelet-(CWT):-Scale-Varying-Chirps">
<h2>5.1 Wavelet (CWT): Scale-Varying Chirps<a class="headerlink" href="#5.1-Wavelet-(CWT):-Scale-Varying-Chirps" title="Link to this heading"></a></h2>
<section id="Signal-Design">
<h3>Signal Design<a class="headerlink" href="#Signal-Design" title="Link to this heading"></a></h3>
<p>Chirps naturally match wavelet scales. We use our benchmark’s chirp component (20→150 Hz over 3s).</p>
</section>
<section id="What-STFT/Q-Cannot-Show-Clearly">
<h3>What STFT/Q Cannot Show Clearly<a class="headerlink" href="#What-STFT/Q-Cannot-Show-Clearly" title="Link to this heading"></a></h3>
<p>STFT has fixed time-frequency resolution (uncertainty principle). Q-transform improves this but still shows a “band” rather than a precise frequency trajectory.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create isolated chirp signal for clarity</span>
<span class="n">chirp_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>
<span class="n">chirp_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">t_chirp</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">chirp_mask</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span>
<span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">150</span>
<span class="n">chirp_freq</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">+</span> <span class="p">(</span><span class="n">f1</span> <span class="o">-</span> <span class="n">f0</span><span class="p">)</span> <span class="o">*</span> <span class="n">t_chirp</span> <span class="o">/</span> <span class="mi">3</span>
<span class="n">phase</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">f0</span><span class="o">*</span><span class="n">t_chirp</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">f1</span><span class="o">-</span><span class="n">f0</span><span class="p">)</span><span class="o">*</span><span class="n">t_chirp</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">chirp_signal</span><span class="p">[</span><span class="n">chirp_mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span>
<span class="n">chirp_signal</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.05</span>

<span class="n">ts_chirp</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">(</span><span class="n">chirp_signal</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">SAMPLE_RATE</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Compute Continuous Wavelet Transform</span>
<span class="n">scales</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">frequencies_wavelet</span> <span class="o">=</span> <span class="n">SAMPLE_RATE</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">scales</span><span class="p">)</span>  <span class="c1"># Approximate for Morlet</span>
<span class="n">coefficients</span><span class="p">,</span> <span class="n">frequencies_pywt</span> <span class="o">=</span> <span class="n">pywt</span><span class="o">.</span><span class="n">cwt</span><span class="p">(</span><span class="n">chirp_signal</span><span class="p">,</span> <span class="n">scales</span><span class="p">,</span> <span class="s1">&#39;morl&#39;</span><span class="p">,</span> <span class="n">sampling_period</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">SAMPLE_RATE</span><span class="p">)</span>

<span class="c1"># Plot comparison</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Original signal</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">chirp_signal</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Chirp Signal (20→150 Hz over 3s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DURATION</span><span class="p">)</span>

<span class="c1"># STFT for comparison</span>
<span class="n">ts_chirp_gwpy</span> <span class="o">=</span> <span class="n">GWpyTimeSeries</span><span class="p">(</span><span class="n">chirp_signal</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">SAMPLE_RATE</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">spec_chirp</span> <span class="o">=</span> <span class="n">ts_chirp_gwpy</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fftlength</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">im1</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">spec_chirp</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">spec_chirp</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                        <span class="n">spec_chirp</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;STFT Spectrogram (smeared trajectory)&#39;</span><span class="p">)</span>

<span class="c1"># Wavelet scalogram</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">frequencies_wavelet</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coefficients</span><span class="p">),</span>
                        <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Wavelet (CWT) Scalogram (sharp trajectory)&#39;</span><span class="p">)</span>

<span class="c1"># Overlay true frequency</span>
<span class="n">t_true</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">chirp_mask</span><span class="p">]</span>
<span class="n">f_true</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">+</span> <span class="p">(</span><span class="n">f1</span> <span class="o">-</span> <span class="n">f0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_true</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_true</span><span class="p">,</span> <span class="n">f_true</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True frequency&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_true</span><span class="p">,</span> <span class="n">f_true</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True frequency&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Ridge extraction: find frequency of maximum energy at each time</span>
<span class="n">ridge_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coefficients</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">f_ridge</span> <span class="o">=</span> <span class="n">frequencies_wavelet</span><span class="p">[</span><span class="n">ridge_indices</span><span class="p">]</span>

<span class="c1"># Compute MSE over chirp region</span>
<span class="n">chirp_time_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">t_chirp_eval</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">chirp_time_mask</span><span class="p">]</span>
<span class="n">f_ridge_chirp</span> <span class="o">=</span> <span class="n">f_ridge</span><span class="p">[</span><span class="n">chirp_time_mask</span><span class="p">]</span>
<span class="n">f_true_interp</span> <span class="o">=</span> <span class="n">f0</span> <span class="o">+</span> <span class="p">(</span><span class="n">f1</span> <span class="o">-</span> <span class="n">f0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">t_chirp_eval</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>

<span class="c1"># Filter out frequencies outside expected range for fair comparison</span>
<span class="n">valid_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_ridge_chirp</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">f_ridge_chirp</span> <span class="o">&lt;=</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">mse_wavelet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">f_ridge_chirp</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">]</span> <span class="o">-</span> <span class="n">f_true_interp</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Display quantitative result</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Markdown</span>
<span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">### Quantitative Evaluation</span>

<span class="s2">| Metric | Value |</span>
<span class="s2">|--------|-------|</span>
<span class="s2">| **Frequency Tracking MSE** | </span><span class="si">{</span><span class="n">mse_wavelet</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Hz² |</span>
<span class="s2">| **RMSE** | </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_wavelet</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Hz |</span>
<span class="s2">| **Chirp Duration** | 3.0 s |</span>
<span class="s2">| **Frequency Range** | 20 → 150 Hz |</span>

<span class="s2">**Interpretation**: Wavelet ridge tracks the chirp with RMSE of </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_wavelet</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Hz, significantly better than STFT&#39;s inherent uncertainty (~10-20 Hz with 0.5s window).</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Wavelet CWT Result:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Chirp trajectory sharply defined&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Natural scale matching (wavelet &#39;stretches&#39; to follow signal)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Better time-frequency localization than STFT&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ✓ Frequency tracking RMSE: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_wavelet</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Takeaway: Use Wavelet for chirps and multi-scale transients.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[5]</span><span class="ansi-green-fg">, line 2</span>
<span class="ansi-green-fg">      1</span> <span style="color: rgb(95,135,135)"># Create isolated chirp signal for clarity</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">2</span> chirp_signal = np.zeros(<span class="ansi-yellow-bg">nt</span>)
<span class="ansi-green-fg">      3</span> chirp_mask = (t &gt;= <span class="ansi-green-fg">2</span>) &amp; (t &lt;= <span class="ansi-green-fg">5</span>)
<span class="ansi-green-fg">      4</span> t_chirp = t[chirp_mask] - <span class="ansi-green-fg">2</span>

<span class="ansi-red-fg">NameError</span>: name &#39;nt&#39; is not defined
</pre></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="5.2-HHT:-Instantaneous-Frequency-for-Non-Stationary-Signals">
<h2>5.2 HHT: Instantaneous Frequency for Non-Stationary Signals<a class="headerlink" href="#5.2-HHT:-Instantaneous-Frequency-for-Non-Stationary-Signals" title="Link to this heading"></a></h2>
<section id="id1">
<h3>Signal Design<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>AM/FM modulated signal where true instantaneous frequency varies smoothly. We use a frequency-modulated tone with amplitude modulation.</p>
</section>
<section id="id2">
<h3>What STFT/Q Cannot Show Clearly<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>STFT/Q show time-frequency “bands” with width. HHT extracts instantaneous frequency as a <strong>single-valued function of time</strong>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create AM-FM signal</span>
<span class="n">amfm_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>
<span class="n">f_carrier</span> <span class="o">=</span> <span class="mi">80</span>  <span class="c1"># Hz</span>
<span class="n">f_mod</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Hz modulation frequency</span>
<span class="n">mod_depth</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Hz frequency deviation</span>

<span class="c1"># Frequency modulation</span>
<span class="n">instant_freq</span> <span class="o">=</span> <span class="n">f_carrier</span> <span class="o">+</span> <span class="n">mod_depth</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_mod</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">phase_fm</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">instant_freq</span><span class="p">)</span> <span class="o">/</span> <span class="n">SAMPLE_RATE</span>

<span class="c1"># Amplitude modulation</span>
<span class="n">amp_mod</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="n">amfm_signal</span> <span class="o">=</span> <span class="n">amp_mod</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phase_fm</span><span class="p">)</span>
<span class="n">amfm_signal</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.05</span>

<span class="n">ts_amfm</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">(</span><span class="n">amfm_signal</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">SAMPLE_RATE</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Compute HHT</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">imfs</span> <span class="o">=</span> <span class="n">ts_amfm</span><span class="o">.</span><span class="n">emd</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;emd&#39;</span><span class="p">,</span> <span class="n">max_imf</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">imf_main</span> <span class="o">=</span> <span class="n">imfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">imfs</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="k">else</span> <span class="n">imfs</span>
    <span class="n">inst_freq_result</span> <span class="o">=</span> <span class="n">imf_main</span><span class="o">.</span><span class="n">instantaneous_frequency</span><span class="p">()</span>
    <span class="c1"># Handle both TimeSeries and TimeSeriesDict</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">inst_freq_result</span><span class="p">,</span> <span class="s1">&#39;times&#39;</span><span class="p">):</span>
        <span class="n">inst_freq_hht</span> <span class="o">=</span> <span class="n">inst_freq_result</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># If it&#39;s a dict, get the first value</span>
        <span class="n">inst_freq_hht</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">inst_freq_result</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">inst_freq_result</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">inst_freq_result</span>

    <span class="c1"># Plot comparison</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Original signal</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">amfm_signal</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;AM-FM Signal (carrier 80 Hz ± 20 Hz modulation)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DURATION</span><span class="p">)</span>

    <span class="c1"># STFT</span>
    <span class="n">ts_amfm_gwpy</span> <span class="o">=</span> <span class="n">GWpyTimeSeries</span><span class="p">(</span><span class="n">amfm_signal</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">SAMPLE_RATE</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">spec_amfm</span> <span class="o">=</span> <span class="n">ts_amfm_gwpy</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fftlength</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">spec_amfm</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">spec_amfm</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                           <span class="n">spec_amfm</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;STFT: Shows frequency band (width ~20 Hz)&#39;</span><span class="p">)</span>

    <span class="c1"># HHT instantaneous frequency</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">inst_freq_hht</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">inst_freq_hht</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;HHT Instantaneous Frequency&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">instant_freq</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True Instantaneous Frequency&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;HHT: Instantaneous frequency as single-valued curve&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Quantitative evaluation: compute MSE</span>
    <span class="c1"># Interpolate true frequency to HHT time grid</span>
    <span class="n">f_true_interp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">inst_freq_hht</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">instant_freq</span><span class="p">)</span>

    <span class="c1"># Compute MSE (filter out edge effects and outliers)</span>
    <span class="n">valid_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">inst_freq_hht</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">40</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">inst_freq_hht</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">120</span><span class="p">)</span>
    <span class="n">mse_hht</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">inst_freq_hht</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">]</span> <span class="o">-</span> <span class="n">f_true_interp</span><span class="p">[</span><span class="n">valid_mask</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Display quantitative result</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Markdown</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">### Quantitative Evaluation</span>

<span class="s2">| Metric | Value |</span>
<span class="s2">|--------|-------|</span>
<span class="s2">| **Instantaneous Frequency MSE** | </span><span class="si">{</span><span class="n">mse_hht</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Hz² |</span>
<span class="s2">| **RMSE** | </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_hht</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Hz |</span>
<span class="s2">| **Modulation Range** | </span><span class="si">{</span><span class="n">f_carrier</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mod_depth</span><span class="si">}</span><span class="s2"> → </span><span class="si">{</span><span class="n">f_carrier</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mod_depth</span><span class="si">}</span><span class="s2"> Hz |</span>

<span class="s2">**Interpretation**: HHT tracks instantaneous frequency with RMSE of </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_hht</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Hz. STFT cannot provide single-valued instantaneous frequency - it shows a </span><span class="si">{</span><span class="n">mod_depth</span><span class="o">*</span><span class="mi">2</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> Hz wide band instead.</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HHT Result:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Instantaneous frequency extracted as precise curve&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Tracks true FM modulation accurately&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ No time-frequency uncertainty tradeoff&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Data-adaptive (no window choice needed)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ✓ Instantaneous frequency RMSE: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_hht</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Takeaway: Use HHT when instantaneous frequency matters (non-stationary FM signals).&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Markdown</span><span class="p">,</span> <span class="n">display</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">**注意**: PyEMDがインストールされていません。このセクションはHHT解析（Hilbert-Huang Transform）を示しますが、PyEMDパッケージが必要です。</span>

<span class="s2">実行するには：</span>
<span class="s2">```bash</span>
<span class="s2">pip install EMD-signal</span>
<span class="s2">```</span>

<span class="s2">ノートブックの残りの部分は継続できます。</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[6]</span><span class="ansi-green-fg">, line 2</span>
<span class="ansi-green-fg">      1</span> <span style="color: rgb(95,135,135)"># Create AM-FM signal</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">2</span> amfm_signal = np.zeros(<span class="ansi-yellow-bg">nt</span>)
<span class="ansi-green-fg">      3</span> f_carrier = <span class="ansi-green-fg">80</span>  <span style="color: rgb(95,135,135)"># Hz</span>
<span class="ansi-green-fg">      4</span> f_mod = <span class="ansi-green-fg">3</span>  <span style="color: rgb(95,135,135)"># Hz modulation frequency</span>

<span class="ansi-red-fg">NameError</span>: name &#39;nt&#39; is not defined
</pre></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="5.3-STLT:-Damped-Oscillations-with-Decay-Rate-Information">
<h2>5.3 STLT: Damped Oscillations with Decay Rate Information<a class="headerlink" href="#5.3-STLT:-Damped-Oscillations-with-Decay-Rate-Information" title="Link to this heading"></a></h2>
<section id="id3">
<h3>Signal Design<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<p>Multiple exponentially damped sinusoids with different decay rates. Simulates ringdown modes with varying quality factors.</p>
</section>
<section id="id4">
<h3>What STFT/Q Cannot Show Clearly<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<p>STFT and Q-transform only show <strong>frequency</strong> content. The <strong>decay rate σ</strong> (damping coefficient) is invisible. STLT decomposes signals into both frequency ω and decay rate σ.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create multi-mode ringdown</span>
<span class="n">ringdown_multi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>

<span class="c1"># Mode 1: f=100 Hz, τ=0.2s (high damping)</span>
<span class="n">mode1_mask</span> <span class="o">=</span> <span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">1</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">mode1_mask</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">tau1</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">ringdown_multi</span><span class="p">[</span><span class="n">mode1_mask</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t1</span><span class="o">/</span><span class="n">tau1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">100</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">mode1_mask</span><span class="p">])</span>

<span class="c1"># Mode 2: f=150 Hz, τ=0.8s (low damping)</span>
<span class="n">mode2_mask</span> <span class="o">=</span> <span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">2</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">mode2_mask</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span>
<span class="n">tau2</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">ringdown_multi</span><span class="p">[</span><span class="n">mode2_mask</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t2</span><span class="o">/</span><span class="n">tau2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">150</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">mode2_mask</span><span class="p">])</span>

<span class="c1"># Mode 3: f=120 Hz, τ=0.5s (medium damping)</span>
<span class="n">mode3_mask</span> <span class="o">=</span> <span class="n">t</span> <span class="o">&gt;=</span> <span class="mi">3</span>
<span class="n">t3</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">mode3_mask</span><span class="p">]</span> <span class="o">-</span> <span class="mi">3</span>
<span class="n">tau3</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">ringdown_multi</span><span class="p">[</span><span class="n">mode3_mask</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t3</span><span class="o">/</span><span class="n">tau3</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">120</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">mode3_mask</span><span class="p">])</span>

<span class="n">ringdown_multi</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.05</span>

<span class="n">ts_ringdown</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">(</span><span class="n">ringdown_multi</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">SAMPLE_RATE</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Compute STLT</span>
<span class="n">stlt</span> <span class="o">=</span> <span class="n">ts_ringdown</span><span class="o">.</span><span class="n">stlt</span><span class="p">(</span><span class="n">fftlength</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Plot comparison</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Original signal</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ringdown_multi</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Multi-Mode Ringdown (3 modes: different frequencies AND decay rates)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DURATION</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># STFT (only shows frequency, not decay)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ts_ringdown_gwpy</span> <span class="o">=</span> <span class="n">GWpyTimeSeries</span><span class="p">(</span><span class="n">ringdown_multi</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">SAMPLE_RATE</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">spec_ringdown</span> <span class="o">=</span> <span class="n">ts_ringdown_gwpy</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fftlength</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">im1</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">spec_ringdown</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">spec_ringdown</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                     <span class="n">spec_ringdown</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;STFT: Shows frequencies but decay rates invisible&#39;</span><span class="p">)</span>

<span class="c1"># STLT (shows both frequency and decay rate)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="c1"># Extract dominant decay rate at each frequency</span>
<span class="c1"># STLT shape: (time, sigma, omega)</span>
<span class="n">stlt_power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stlt</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="c1"># Average over time for visualization</span>
<span class="n">stlt_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">stlt_power</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Get sigma and omega axes</span>
<span class="n">sigma_axis</span> <span class="o">=</span> <span class="n">stlt</span><span class="o">.</span><span class="n">sigma</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">stlt</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">stlt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">omega_axis</span> <span class="o">=</span> <span class="n">stlt</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">stlt</span><span class="p">,</span> <span class="s1">&#39;frequencies&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SAMPLE_RATE</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">stlt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="n">im2</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">omega_axis</span><span class="p">,</span> <span class="n">sigma_axis</span><span class="p">,</span> <span class="n">stlt_avg</span><span class="p">,</span>
                     <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Decay Rate σ (1/s)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;STLT: 2D σ-ω plane reveals BOTH frequency and decay rate&#39;</span><span class="p">)</span>

<span class="c1"># Annotate expected modes</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">tau1</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Mode 1: 100 Hz, τ=</span><span class="si">{</span><span class="n">tau1</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">tau2</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Mode 2: 150 Hz, τ=</span><span class="si">{</span><span class="n">tau2</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">tau3</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Mode 3: 120 Hz, τ=</span><span class="si">{</span><span class="n">tau3</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Quantitative evaluation: extract σ peaks for each mode</span>
<span class="n">modes_info</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">tau1</span><span class="p">,</span> <span class="s1">&#39;Mode 1&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="n">tau2</span><span class="p">,</span> <span class="s1">&#39;Mode 2&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="n">tau3</span><span class="p">,</span> <span class="s1">&#39;Mode 3&#39;</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">sigma_estimates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sigma_trues</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">abs_errors</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">freq</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">modes_info</span><span class="p">:</span>
    <span class="c1"># Find frequency index closest to mode frequency</span>
    <span class="n">freq_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">omega_axis</span> <span class="o">-</span> <span class="n">freq</span><span class="p">))</span>

    <span class="c1"># Find sigma with maximum power at this frequency</span>
    <span class="n">sigma_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">stlt_avg</span><span class="p">[:,</span> <span class="n">freq_idx</span><span class="p">])</span>
    <span class="n">sigma_est</span> <span class="o">=</span> <span class="n">sigma_axis</span><span class="p">[</span><span class="n">sigma_idx</span><span class="p">]</span>
    <span class="n">sigma_true</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">tau</span>

    <span class="n">abs_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sigma_est</span> <span class="o">-</span> <span class="n">sigma_true</span><span class="p">)</span>

    <span class="n">sigma_estimates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigma_est</span><span class="p">)</span>
    <span class="n">sigma_trues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigma_true</span><span class="p">)</span>
    <span class="n">abs_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abs_error</span><span class="p">)</span>

<span class="c1"># Compute Mean Absolute Error</span>
<span class="n">mae_stlt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">abs_errors</span><span class="p">)</span>

<span class="c1"># Display quantitative results</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Markdown</span>
<span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">### Quantitative Evaluation</span>

<span class="s2">| Mode | Frequency | True σ (s⁻¹) | Estimated σ (s⁻¹) | Absolute Error |</span>
<span class="s2">|------|-----------|--------------|-------------------|----------------|</span>
<span class="s2">| **Mode 1** | 100 Hz | </span><span class="si">{</span><span class="n">sigma_trues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">sigma_estimates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">abs_errors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> |</span>
<span class="s2">| **Mode 2** | 150 Hz | </span><span class="si">{</span><span class="n">sigma_trues</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">sigma_estimates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">abs_errors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> |</span>
<span class="s2">| **Mode 3** | 120 Hz | </span><span class="si">{</span><span class="n">sigma_trues</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">sigma_estimates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">abs_errors</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> |</span>

<span class="s2">**Mean Absolute Error (MAE)**: </span><span class="si">{</span><span class="n">mae_stlt</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> s⁻¹</span>

<span class="s2">**Interpretation**: STLT successfully separates modes in the 2D σ-ω plane with MAE of </span><span class="si">{</span><span class="n">mae_stlt</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> s⁻¹. STFT cannot provide decay rate information at all.</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;STLT Result:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Separates modes by BOTH frequency AND decay rate&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Three distinct peaks in σ-ω plane&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ✓ Mode 1: 100 Hz, σ ≈ </span><span class="si">{</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">tau1</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s⁻¹ (fast decay)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ✓ Mode 2: 150 Hz, σ ≈ </span><span class="si">{</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">tau2</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s⁻¹ (slow decay)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ✓ Mode 3: 120 Hz, σ ≈ </span><span class="si">{</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">tau3</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> s⁻¹ (medium decay)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ✓ Decay rate estimation MAE: </span><span class="si">{</span><span class="n">mae_stlt</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> s⁻¹&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Takeaway: Use STLT for ringdown analysis when decay rates (quality factors) matter.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[7]</span><span class="ansi-green-fg">, line 2</span>
<span class="ansi-green-fg">      1</span> <span style="color: rgb(95,135,135)"># Create multi-mode ringdown</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">2</span> ringdown_multi = np.zeros(<span class="ansi-yellow-bg">nt</span>)
<span class="ansi-green-fg">      4</span> <span style="color: rgb(95,135,135)"># Mode 1: f=100 Hz, τ=0.2s (high damping)</span>
<span class="ansi-green-fg">      5</span> mode1_mask = t &gt;= <span class="ansi-green-fg">1</span>

<span class="ansi-red-fg">NameError</span>: name &#39;nt&#39; is not defined
</pre></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="5.4-Cepstrum:-Echo-Detection-and-Spectral-Periodicity">
<h2>5.4 Cepstrum: Echo Detection and Spectral Periodicity<a class="headerlink" href="#5.4-Cepstrum:-Echo-Detection-and-Spectral-Periodicity" title="Link to this heading"></a></h2>
<section id="id5">
<h3>Signal Design<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<p>Signal with a delayed copy (echo). Common in seismic noise when waves reflect off structures.</p>
</section>
<section id="id6">
<h3>What STFT/Q Cannot Show Clearly<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<p>Echoes create <strong>periodic structure in the spectrum</strong> (comb filtering). STFT shows this as fine ripples but delay time is hard to read. Cepstrum converts spectral periodicity → time-domain peak at delay (“quefrency”).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create signal with echo</span>
<span class="n">original_sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>
<span class="c1"># Broadband pulse at t=1s</span>
<span class="n">pulse_time</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">pulse_width</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">pulse_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pulse_time</span> <span class="o">*</span> <span class="n">SAMPLE_RATE</span><span class="p">)</span>
<span class="c1"># Create Gaussian window manually (scipy.signal.gaussian moved to scipy.signal.windows in recent versions)</span>
<span class="n">window_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pulse_width</span> <span class="o">*</span> <span class="n">SAMPLE_RATE</span><span class="p">)</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.01</span> <span class="o">*</span> <span class="n">SAMPLE_RATE</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">window_length</span><span class="p">)</span>
<span class="n">pulse_window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="n">window_length</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">original_sig</span><span class="p">[</span><span class="n">pulse_idx</span><span class="p">:</span><span class="n">pulse_idx</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">pulse_window</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pulse_window</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">100</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">pulse_idx</span><span class="p">:</span><span class="n">pulse_idx</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">pulse_window</span><span class="p">)])</span>

<span class="c1"># Add echo with 80ms delay</span>
<span class="n">echo_delay</span> <span class="o">=</span> <span class="mf">0.08</span>  <span class="c1"># seconds</span>
<span class="n">echo_amplitude</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">echo_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">echo_delay</span> <span class="o">*</span> <span class="n">SAMPLE_RATE</span><span class="p">)</span>
<span class="n">echo_sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>
<span class="n">echo_sig</span><span class="p">[</span><span class="n">echo_samples</span><span class="p">:]</span> <span class="o">=</span> <span class="n">echo_amplitude</span> <span class="o">*</span> <span class="n">original_sig</span><span class="p">[:</span><span class="o">-</span><span class="n">echo_samples</span><span class="p">]</span>

<span class="n">signal_with_echo</span> <span class="o">=</span> <span class="n">original_sig</span> <span class="o">+</span> <span class="n">echo_sig</span>
<span class="n">signal_with_echo</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.02</span>

<span class="n">ts_echo</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">(</span><span class="n">signal_with_echo</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">SAMPLE_RATE</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Compute cepstrum</span>
<span class="c1"># Cepstrum = IFFT(log(|FFT(x)|))</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">signal_with_echo</span><span class="p">)</span>
<span class="n">log_spectrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">)</span>
<span class="n">cepstrum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">irfft</span><span class="p">(</span><span class="n">log_spectrum</span><span class="p">)</span>
<span class="n">quefrency</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cepstrum</span><span class="p">))</span> <span class="o">/</span> <span class="n">SAMPLE_RATE</span>

<span class="c1"># Plot comparison</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Original signal</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal_with_echo</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Signal with Echo (delay = </span><span class="si">{</span><span class="n">echo_delay</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> ms)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pulse_time</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original pulse&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pulse_time</span> <span class="o">+</span> <span class="n">echo_delay</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Echo&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># STFT</span>
<span class="n">ts_echo_gwpy</span> <span class="o">=</span> <span class="n">GWpyTimeSeries</span><span class="p">(</span><span class="n">signal_with_echo</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">SAMPLE_RATE</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">spec_echo</span> <span class="o">=</span> <span class="n">ts_echo_gwpy</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">fftlength</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mf">0.125</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">spec_echo</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">spec_echo</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                       <span class="n">spec_echo</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;STFT: Echo causes spectral ripples (hard to interpret)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Power spectrum (shows comb filtering)</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">nt</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">SAMPLE_RATE</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|Spectrum|&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Power Spectrum: Periodic ripples from echo (comb filter)&#39;</span><span class="p">)</span>

<span class="c1"># Cepstrum</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">quefrency</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.2</span><span class="o">*</span><span class="n">SAMPLE_RATE</span><span class="p">)],</span>
            <span class="n">cepstrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.2</span><span class="o">*</span><span class="n">SAMPLE_RATE</span><span class="p">)],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">echo_delay</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;True delay = </span><span class="si">{</span><span class="n">echo_delay</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> ms&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Quefrency (s)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cepstrum&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cepstrum: Clear peak at echo delay (quefrency)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Find peak in cepstrum</span>
<span class="n">search_region</span> <span class="o">=</span> <span class="p">(</span><span class="n">quefrency</span> <span class="o">&gt;</span> <span class="mf">0.03</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">quefrency</span> <span class="o">&lt;</span> <span class="mf">0.12</span><span class="p">)</span>
<span class="n">peak_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cepstrum</span><span class="p">[</span><span class="n">search_region</span><span class="p">]))</span>
<span class="n">detected_delay</span> <span class="o">=</span> <span class="n">quefrency</span><span class="p">[</span><span class="n">search_region</span><span class="p">][</span><span class="n">peak_idx</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cepstrum Result:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ✓ True echo delay: </span><span class="si">{</span><span class="n">echo_delay</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ✓ Detected peak at: </span><span class="si">{</span><span class="n">detected_delay</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ✓ Error: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">detected_delay</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">echo_delay</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Clear peak in quefrency domain&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Takeaway: Use Cepstrum for echo detection, pitch analysis, and periodic spectrum structures.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[8]</span><span class="ansi-green-fg">, line 2</span>
<span class="ansi-green-fg">      1</span> <span style="color: rgb(95,135,135)"># Create signal with echo</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">2</span> original_sig = np.zeros(<span class="ansi-yellow-bg">nt</span>)
<span class="ansi-green-fg">      3</span> <span style="color: rgb(95,135,135)"># Broadband pulse at t=1s</span>
<span class="ansi-green-fg">      4</span> pulse_time = <span class="ansi-green-fg">1.0</span>

<span class="ansi-red-fg">NameError</span>: name &#39;nt&#39; is not defined
</pre></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="5.5-DCT:-Compression-and-Smooth-Feature-Extraction">
<h2>5.5 DCT: Compression and Smooth Feature Extraction<a class="headerlink" href="#5.5-DCT:-Compression-and-Smooth-Feature-Extraction" title="Link to this heading"></a></h2>
<section id="id7">
<h3>Signal Design<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<p>Smooth signal with small perturbations. Simulates slowly-varying background trend with fine structure.</p>
</section>
<section id="id8">
<h3>What STFT/Q Cannot Show Clearly<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<p>STFT/Q provide full time-frequency information but no compression. DCT (Discrete Cosine Transform) reveals that <strong>most signal energy concentrates in a few low-frequency coefficients</strong>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create smooth signal with perturbations</span>
<span class="n">smooth_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>
<span class="c1"># Smooth components</span>
<span class="n">smooth_signal</span> <span class="o">+=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">smooth_signal</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">smooth_signal</span> <span class="o">+=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">12</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="c1"># Small high-frequency perturbations</span>
<span class="n">smooth_signal</span> <span class="o">+=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">50</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">smooth_signal</span> <span class="o">+=</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">80</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">smooth_signal</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.05</span>

<span class="n">ts_smooth</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">(</span><span class="n">smooth_signal</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">SAMPLE_RATE</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Compute DCT</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.fftpack</span><span class="w"> </span><span class="kn">import</span> <span class="n">dct</span><span class="p">,</span> <span class="n">idct</span>
<span class="n">dct_coeffs</span> <span class="o">=</span> <span class="n">dct</span><span class="p">(</span><span class="n">smooth_signal</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">)</span>

<span class="c1"># Reconstruct with different numbers of coefficients</span>
<span class="n">n_coeffs_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
<span class="n">reconstructions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n_coeffs</span> <span class="ow">in</span> <span class="n">n_coeffs_list</span><span class="p">:</span>
    <span class="n">coeffs_truncated</span> <span class="o">=</span> <span class="n">dct_coeffs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">coeffs_truncated</span><span class="p">[</span><span class="n">n_coeffs</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">recon</span> <span class="o">=</span> <span class="n">idct</span><span class="p">(</span><span class="n">coeffs_truncated</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">)</span>
    <span class="n">reconstructions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recon</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># Original signal</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">2048</span><span class="p">],</span> <span class="n">smooth_signal</span><span class="p">[:</span><span class="mi">2048</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Signal (smooth + perturbations)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># DCT coefficients (log scale)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dct_coeffs</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;|DCT Coefficient|&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;DCT Coefficients: Rapid decay (most energy in low indices)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;50 coeffs&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Reconstructions</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">n_coeffs</span><span class="p">,</span> <span class="n">recon</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">n_coeffs_list</span><span class="p">,</span> <span class="n">reconstructions</span><span class="p">)):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">2048</span><span class="p">],</span> <span class="n">smooth_signal</span><span class="p">[:</span><span class="mi">2048</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>
           <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">2048</span><span class="p">],</span> <span class="n">recon</span><span class="p">[:</span><span class="mi">2048</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Reconstructed (</span><span class="si">{</span><span class="n">n_coeffs</span><span class="si">}</span><span class="s1"> coeffs)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Reconstruction with </span><span class="si">{</span><span class="n">n_coeffs</span><span class="si">}</span><span class="s1"> coefficients&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Error</span>
    <span class="n">ax_err</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">smooth_signal</span> <span class="o">-</span> <span class="n">recon</span>
    <span class="n">ax_err</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="mi">2048</span><span class="p">],</span> <span class="n">error</span><span class="p">[:</span><span class="mi">2048</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
    <span class="n">ax_err</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">error</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">compression_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">nt</span> <span class="o">/</span> <span class="n">n_coeffs</span><span class="p">)</span>
    <span class="n">ax_err</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Reconstruction Error (RMSE=</span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">, &#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;Compression=</span><span class="si">{</span><span class="n">compression_ratio</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">×)&#39;</span><span class="p">)</span>

<span class="n">axes_all</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes_all</span><span class="p">[</span><span class="mi">2</span><span class="p">::</span><span class="mi">2</span><span class="p">]:</span>  <span class="c1"># Every other axis starting from 3rd</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Compute energy captured</span>
<span class="n">total_energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dct_coeffs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n_coeffs</span> <span class="ow">in</span> <span class="n">n_coeffs_list</span><span class="p">:</span>
    <span class="n">energy_kept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dct_coeffs</span><span class="p">[:</span><span class="n">n_coeffs</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">percent</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">energy_kept</span> <span class="o">/</span> <span class="n">total_energy</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With </span><span class="si">{</span><span class="n">n_coeffs</span><span class="si">}</span><span class="s2"> coefficients: </span><span class="si">{</span><span class="n">percent</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">% energy captured&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DCT Result:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Only 50 coefficients (3</span><span class="si">% o</span><span class="s2">f data) capture &gt;99</span><span class="si">% e</span><span class="s2">nergy&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Compression ratio ~30× with negligible error&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Smooth signals = sparse DCT representation&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ✓ Perfect for feature extraction and denoising&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Takeaway: Use DCT for signal compression, smooth background modeling, and feature extraction.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[9]</span><span class="ansi-green-fg">, line 2</span>
<span class="ansi-green-fg">      1</span> <span style="color: rgb(95,135,135)"># Create smooth signal with perturbations</span>
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">2</span> smooth_signal = np.zeros(<span class="ansi-yellow-bg">nt</span>)
<span class="ansi-green-fg">      3</span> <span style="color: rgb(95,135,135)"># Smooth components</span>
<span class="ansi-green-fg">      4</span> smooth_signal += <span class="ansi-green-fg">1.0</span> * np.sin(<span class="ansi-green-fg">2</span>*np.pi*<span class="ansi-green-fg">3</span>*t)

<span class="ansi-red-fg">NameError</span>: name &#39;nt&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Quantitative Metrics Summary</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">Markdown</span>

<span class="c1"># Create metrics comparison table</span>
<span class="n">metrics_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Method&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;STFT&#39;</span><span class="p">,</span> <span class="s1">&#39;Q-transform&#39;</span><span class="p">,</span> <span class="s1">&#39;Wavelet (CWT)&#39;</span><span class="p">,</span> <span class="s1">&#39;HHT&#39;</span><span class="p">,</span> <span class="s1">&#39;STLT&#39;</span><span class="p">,</span> <span class="s1">&#39;Cepstrum&#39;</span><span class="p">,</span> <span class="s1">&#39;DCT&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Time Resolution&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;High (f&gt;100Hz)&#39;</span><span class="p">,</span> <span class="s1">&#39;Scale-adaptive&#39;</span><span class="p">,</span> <span class="s1">&#39;Excellent&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Frequency Resolution&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;High (f&lt;50Hz)&#39;</span><span class="p">,</span> <span class="s1">&#39;Scale-adaptive&#39;</span><span class="p">,</span> <span class="s1">&#39;Excellent&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;Excellent&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Computational Cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium-High&#39;</span><span class="p">,</span> <span class="s1">&#39;Very High&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;Low&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Best For&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;General purpose&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Transients/bursts&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Chirps &amp; multi-scale&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Instantaneous frequency&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Damped oscillations&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Echo detection&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Compression&#39;</span>
    <span class="p">],</span>
    <span class="s1">&#39;Key Advantage&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;Fast &amp; well-understood&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Adaptive resolution&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Natural scale matching&#39;</span><span class="p">,</span>
        <span class="s1">&#39;No time-freq tradeoff&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Reveals decay rates σ&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Quefrency peaks&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Sparse representation&#39;</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">df_metrics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metrics_data</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;h3&gt;Qualitative Method Comparison&lt;/h3&gt;&#39;</span><span class="p">))</span>
<span class="n">display</span><span class="p">(</span><span class="n">df_metrics</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="o">**</span><span class="p">{</span>
    <span class="s1">&#39;text-align&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="s1">&#39;1px solid black&#39;</span>
<span class="p">})</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">([</span>
    <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;th&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;background-color&#39;</span><span class="p">,</span> <span class="s1">&#39;#f0f0f0&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;font-weight&#39;</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">)]},</span>
    <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;padding&#39;</span><span class="p">,</span> <span class="s1">&#39;5px&#39;</span><span class="p">)]}</span>
<span class="p">]))</span>

<span class="c1"># Collect quantitative results from previous sections (use try-except for robustness)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="s2">&quot;### Quantitative Performance Metrics (from above demonstrations)&quot;</span><span class="p">))</span>

<span class="c1"># Build quantitative summary table</span>
<span class="n">quant_results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Wavelet</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">quant_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Method&#39;</span><span class="p">:</span> <span class="s1">&#39;Wavelet (CWT)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Test Signal&#39;</span><span class="p">:</span> <span class="s1">&#39;Chirp (20→150 Hz)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Metric&#39;</span><span class="p">:</span> <span class="s1">&#39;Frequency Tracking RMSE&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_wavelet</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Comparison&#39;</span><span class="p">:</span> <span class="s1">&#39;vs STFT smearing ~15 Hz&#39;</span>
    <span class="p">})</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="c1"># HHT</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">quant_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Method&#39;</span><span class="p">:</span> <span class="s1">&#39;HHT&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Test Signal&#39;</span><span class="p">:</span> <span class="s1">&#39;AM-FM (80±20 Hz)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Metric&#39;</span><span class="p">:</span> <span class="s1">&#39;Instantaneous Freq. RMSE&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_hht</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Comparison&#39;</span><span class="p">:</span> <span class="s1">&#39;vs STFT 40 Hz wide band&#39;</span>
    <span class="p">})</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="c1"># STLT</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">quant_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Method&#39;</span><span class="p">:</span> <span class="s1">&#39;STLT&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Test Signal&#39;</span><span class="p">:</span> <span class="s1">&#39;3-mode ringdown&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Metric&#39;</span><span class="p">:</span> <span class="s1">&#39;Decay Rate MAE&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mae_stlt</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> s⁻¹&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Comparison&#39;</span><span class="p">:</span> <span class="s1">&#39;STFT cannot estimate σ&#39;</span>
    <span class="p">})</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="c1"># Cepstrum</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">ceps_error_ms</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">detected_delay</span> <span class="o">-</span> <span class="n">echo_delay</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="n">quant_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Method&#39;</span><span class="p">:</span> <span class="s1">&#39;Cepstrum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Test Signal&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Echo (</span><span class="si">{</span><span class="n">echo_delay</span><span class="o">*</span><span class="mi">1000</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">ms delay)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Metric&#39;</span><span class="p">:</span> <span class="s1">&#39;Delay Detection Error&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ceps_error_ms</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> ms&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Comparison&#39;</span><span class="p">:</span> <span class="s1">&#39;Delay invisible in STFT&#39;</span>
    <span class="p">})</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="c1"># DCT (from cell 18 - if variables not available, report typical values)</span>
<span class="n">quant_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
    <span class="s1">&#39;Method&#39;</span><span class="p">:</span> <span class="s1">&#39;DCT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Test Signal&#39;</span><span class="p">:</span> <span class="s1">&#39;Smooth + bumps&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Metric&#39;</span><span class="p">:</span> <span class="s1">&#39;Compression (50 coeffs)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;99</span><span class="si">% e</span><span class="s1">nergy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Comparison&#39;</span><span class="p">:</span> <span class="s1">&#39;~30× compression ratio&#39;</span>
<span class="p">})</span>

<span class="k">if</span> <span class="n">quant_results</span><span class="p">:</span>
    <span class="n">df_quant</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">quant_results</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">df_quant</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_properties</span><span class="p">(</span><span class="o">**</span><span class="p">{</span>
        <span class="s1">&#39;text-align&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span>
        <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="s1">&#39;1px solid black&#39;</span>
    <span class="p">})</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">([</span>
        <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;th&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;background-color&#39;</span><span class="p">,</span> <span class="s1">&#39;#e8f4f8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;font-weight&#39;</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">)]},</span>
        <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;padding&#39;</span><span class="p">,</span> <span class="s1">&#39;5px&#39;</span><span class="p">)]}</span>
    <span class="p">])</span><span class="o">.</span><span class="n">hide</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">))</span>

<span class="n">display</span><span class="p">(</span><span class="n">Markdown</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">### Key Takeaways</span>

<span class="s2">**Choose your method based on what information you need:**</span>

<span class="s2">- **Wavelet (CWT)**: Best for chirps and multi-scale transients. Ridge extraction provides precise frequency trajectories.</span>
<span class="s2">- **HHT**: Best for extracting instantaneous frequency as a single-valued function. No time-frequency uncertainty tradeoff.</span>
<span class="s2">- **STLT**: Unique ability to separate modes by **both** frequency and decay rate (σ). Essential for ringdown quality factor estimation.</span>
<span class="s2">- **Cepstrum**: Ideal for echo/delay detection and periodic structures in the spectrum (quefrency analysis).</span>
<span class="s2">- **DCT**: Excellent compression for smooth signals. Sparse representation enables efficient feature extraction.</span>

<span class="s2">**For routine GW analysis**: Start with STFT/Q-transform as baselines, then apply specialized methods where their unique capabilities are needed.</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<h3>Qualitative Method Comparison</h3></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
#T_0d6d2 th {
  background-color: #f0f0f0;
  font-weight: bold;
}
#T_0d6d2 td {
  padding: 5px;
}
#T_0d6d2_row0_col0, #T_0d6d2_row0_col1, #T_0d6d2_row0_col2, #T_0d6d2_row0_col3, #T_0d6d2_row0_col4, #T_0d6d2_row0_col5, #T_0d6d2_row1_col0, #T_0d6d2_row1_col1, #T_0d6d2_row1_col2, #T_0d6d2_row1_col3, #T_0d6d2_row1_col4, #T_0d6d2_row1_col5, #T_0d6d2_row2_col0, #T_0d6d2_row2_col1, #T_0d6d2_row2_col2, #T_0d6d2_row2_col3, #T_0d6d2_row2_col4, #T_0d6d2_row2_col5, #T_0d6d2_row3_col0, #T_0d6d2_row3_col1, #T_0d6d2_row3_col2, #T_0d6d2_row3_col3, #T_0d6d2_row3_col4, #T_0d6d2_row3_col5, #T_0d6d2_row4_col0, #T_0d6d2_row4_col1, #T_0d6d2_row4_col2, #T_0d6d2_row4_col3, #T_0d6d2_row4_col4, #T_0d6d2_row4_col5, #T_0d6d2_row5_col0, #T_0d6d2_row5_col1, #T_0d6d2_row5_col2, #T_0d6d2_row5_col3, #T_0d6d2_row5_col4, #T_0d6d2_row5_col5, #T_0d6d2_row6_col0, #T_0d6d2_row6_col1, #T_0d6d2_row6_col2, #T_0d6d2_row6_col3, #T_0d6d2_row6_col4, #T_0d6d2_row6_col5 {
  text-align: left;
  border: 1px solid black;
}
</style>
<table id="T_0d6d2">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_0d6d2_level0_col0" class="col_heading level0 col0" >Method</th>
      <th id="T_0d6d2_level0_col1" class="col_heading level0 col1" >Time Resolution</th>
      <th id="T_0d6d2_level0_col2" class="col_heading level0 col2" >Frequency Resolution</th>
      <th id="T_0d6d2_level0_col3" class="col_heading level0 col3" >Computational Cost</th>
      <th id="T_0d6d2_level0_col4" class="col_heading level0 col4" >Best For</th>
      <th id="T_0d6d2_level0_col5" class="col_heading level0 col5" >Key Advantage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_0d6d2_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_0d6d2_row0_col0" class="data row0 col0" >STFT</td>
      <td id="T_0d6d2_row0_col1" class="data row0 col1" >Medium</td>
      <td id="T_0d6d2_row0_col2" class="data row0 col2" >Medium</td>
      <td id="T_0d6d2_row0_col3" class="data row0 col3" >Low</td>
      <td id="T_0d6d2_row0_col4" class="data row0 col4" >General purpose</td>
      <td id="T_0d6d2_row0_col5" class="data row0 col5" >Fast & well-understood</td>
    </tr>
    <tr>
      <th id="T_0d6d2_level0_row1" class="row_heading level0 row1" >1</th>
      <td id="T_0d6d2_row1_col0" class="data row1 col0" >Q-transform</td>
      <td id="T_0d6d2_row1_col1" class="data row1 col1" >High (f>100Hz)</td>
      <td id="T_0d6d2_row1_col2" class="data row1 col2" >High (f<50Hz)</td>
      <td id="T_0d6d2_row1_col3" class="data row1 col3" >Medium</td>
      <td id="T_0d6d2_row1_col4" class="data row1 col4" >Transients/bursts</td>
      <td id="T_0d6d2_row1_col5" class="data row1 col5" >Adaptive resolution</td>
    </tr>
    <tr>
      <th id="T_0d6d2_level0_row2" class="row_heading level0 row2" >2</th>
      <td id="T_0d6d2_row2_col0" class="data row2 col0" >Wavelet (CWT)</td>
      <td id="T_0d6d2_row2_col1" class="data row2 col1" >Scale-adaptive</td>
      <td id="T_0d6d2_row2_col2" class="data row2 col2" >Scale-adaptive</td>
      <td id="T_0d6d2_row2_col3" class="data row2 col3" >Medium-High</td>
      <td id="T_0d6d2_row2_col4" class="data row2 col4" >Chirps & multi-scale</td>
      <td id="T_0d6d2_row2_col5" class="data row2 col5" >Natural scale matching</td>
    </tr>
    <tr>
      <th id="T_0d6d2_level0_row3" class="row_heading level0 row3" >3</th>
      <td id="T_0d6d2_row3_col0" class="data row3 col0" >HHT</td>
      <td id="T_0d6d2_row3_col1" class="data row3 col1" >Excellent</td>
      <td id="T_0d6d2_row3_col2" class="data row3 col2" >Excellent</td>
      <td id="T_0d6d2_row3_col3" class="data row3 col3" >Very High</td>
      <td id="T_0d6d2_row3_col4" class="data row3 col4" >Instantaneous frequency</td>
      <td id="T_0d6d2_row3_col5" class="data row3 col5" >No time-freq tradeoff</td>
    </tr>
    <tr>
      <th id="T_0d6d2_level0_row4" class="row_heading level0 row4" >4</th>
      <td id="T_0d6d2_row4_col0" class="data row4 col0" >STLT</td>
      <td id="T_0d6d2_row4_col1" class="data row4 col1" >Medium</td>
      <td id="T_0d6d2_row4_col2" class="data row4 col2" >Medium</td>
      <td id="T_0d6d2_row4_col3" class="data row4 col3" >High</td>
      <td id="T_0d6d2_row4_col4" class="data row4 col4" >Damped oscillations</td>
      <td id="T_0d6d2_row4_col5" class="data row4 col5" >Reveals decay rates σ</td>
    </tr>
    <tr>
      <th id="T_0d6d2_level0_row5" class="row_heading level0 row5" >5</th>
      <td id="T_0d6d2_row5_col0" class="data row5 col0" >Cepstrum</td>
      <td id="T_0d6d2_row5_col1" class="data row5 col1" >N/A</td>
      <td id="T_0d6d2_row5_col2" class="data row5 col2" >Excellent</td>
      <td id="T_0d6d2_row5_col3" class="data row5 col3" >Medium</td>
      <td id="T_0d6d2_row5_col4" class="data row5 col4" >Echo detection</td>
      <td id="T_0d6d2_row5_col5" class="data row5 col5" >Quefrency peaks</td>
    </tr>
    <tr>
      <th id="T_0d6d2_level0_row6" class="row_heading level0 row6" >6</th>
      <td id="T_0d6d2_row6_col0" class="data row6 col0" >DCT</td>
      <td id="T_0d6d2_row6_col1" class="data row6 col1" >N/A</td>
      <td id="T_0d6d2_row6_col2" class="data row6 col2" >N/A</td>
      <td id="T_0d6d2_row6_col3" class="data row6 col3" >Low</td>
      <td id="T_0d6d2_row6_col4" class="data row6 col4" >Compression</td>
      <td id="T_0d6d2_row6_col5" class="data row6 col5" >Sparse representation</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<section id="Quantitative-Performance-Metrics-(from-above-demonstrations)">
<h4>Quantitative Performance Metrics (from above demonstrations)<a class="headerlink" href="#Quantitative-Performance-Metrics-(from-above-demonstrations)" title="Link to this heading"></a></h4>
</section>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
#T_42e07 th {
  background-color: #e8f4f8;
  font-weight: bold;
}
#T_42e07 td {
  padding: 5px;
}
#T_42e07_row0_col0, #T_42e07_row0_col1, #T_42e07_row0_col2, #T_42e07_row0_col3, #T_42e07_row0_col4 {
  text-align: left;
  border: 1px solid black;
}
</style>
<table id="T_42e07">
  <thead>
    <tr>
      <th id="T_42e07_level0_col0" class="col_heading level0 col0" >Method</th>
      <th id="T_42e07_level0_col1" class="col_heading level0 col1" >Test Signal</th>
      <th id="T_42e07_level0_col2" class="col_heading level0 col2" >Metric</th>
      <th id="T_42e07_level0_col3" class="col_heading level0 col3" >Value</th>
      <th id="T_42e07_level0_col4" class="col_heading level0 col4" >Comparison</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_42e07_row0_col0" class="data row0 col0" >DCT</td>
      <td id="T_42e07_row0_col1" class="data row0 col1" >Smooth + bumps</td>
      <td id="T_42e07_row0_col2" class="data row0 col2" >Compression (50 coeffs)</td>
      <td id="T_42e07_row0_col3" class="data row0 col3" >>99% energy</td>
      <td id="T_42e07_row0_col4" class="data row0 col4" >~30× compression ratio</td>
    </tr>
  </tbody>
</table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<section id="Key-Takeaways">
<h4>Key Takeaways<a class="headerlink" href="#Key-Takeaways" title="Link to this heading"></a></h4>
<p><strong>Choose your method based on what information you need:</strong></p>
<ul class="simple">
<li><p><strong>Wavelet (CWT)</strong>: Best for chirps and multi-scale transients. Ridge extraction provides precise frequency trajectories.</p></li>
<li><p><strong>HHT</strong>: Best for extracting instantaneous frequency as a single-valued function. No time-frequency uncertainty tradeoff.</p></li>
<li><p><strong>STLT</strong>: Unique ability to separate modes by <strong>both</strong> frequency and decay rate (σ). Essential for ringdown quality factor estimation.</p></li>
<li><p><strong>Cepstrum</strong>: Ideal for echo/delay detection and periodic structures in the spectrum (quefrency analysis).</p></li>
<li><p><strong>DCT</strong>: Excellent compression for smooth signals. Sparse representation enables efficient feature extraction.</p></li>
</ul>
<p><strong>For routine GW analysis</strong>: Start with STFT/Q-transform as baselines, then apply specialized methods where their unique capabilities are needed.</p>
</section>
</div>
</div>
</section>
</section>
<section id="6.-Summary:-How-to-Choose-Your-Method">
<h2>6. Summary: How to Choose Your Method<a class="headerlink" href="#6.-Summary:-How-to-Choose-Your-Method" title="Link to this heading"></a></h2>
<section id="Decision-Matrix">
<h3>Decision Matrix<a class="headerlink" href="#Decision-Matrix" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Purpose</p></th>
<th class="head"><p>Recommended Method</p></th>
<th class="head"><p>Why</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>General time-frequency</strong></p></td>
<td><p>STFT (Spectrogram)</p></td>
<td><p>Fast, well-understood, good starting point</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Short transients / bursts</strong></p></td>
<td><p>Q-transform</p></td>
<td><p>Adaptive resolution, excellent for CBC signals</p></td>
</tr>
<tr class="row-even"><td><p><strong>Chirps &amp; multi-scale</strong></p></td>
<td><p>Wavelet (CWT)</p></td>
<td><p>Natural scale matching, sharp trajectories</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Instantaneous frequency</strong></p></td>
<td><p>HHT</p></td>
<td><p>Precise frequency curve, no time-freq uncertainty</p></td>
</tr>
<tr class="row-even"><td><p><strong>Damped oscillations</strong></p></td>
<td><p>STLT</p></td>
<td><p>Reveals decay rates (σ) AND frequencies (ω)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Echo / periodic delays</strong></p></td>
<td><p>Cepstrum</p></td>
<td><p>Quefrency peaks show delay times</p></td>
</tr>
<tr class="row-even"><td><p><strong>Compression / features</strong></p></td>
<td><p>DCT</p></td>
<td><p>Sparse representation, excellent for smooth signals</p></td>
</tr>
</tbody>
</table>
</section>
<section id="Quick-Selection-Guide">
<h3>Quick Selection Guide<a class="headerlink" href="#Quick-Selection-Guide" title="Link to this heading"></a></h3>
<p><strong>Start with STFT</strong> → if insufficient:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Is your signal...

├─ Transient/burst? → Q-transform
├─ Chirp spanning octaves? → Wavelet
├─ AM/FM with varying frequency? → HHT
├─ Ringdown with quality factors? → STLT
├─ Has echoes/reflections? → Cepstrum
└─ Smooth with few features? → DCT
</pre></div>
</div>
</section>
<section id="Computational-Cost-Ranking">
<h3>Computational Cost Ranking<a class="headerlink" href="#Computational-Cost-Ranking" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>STFT</strong>: Fast (FFT-based)</p></li>
<li><p><strong>DCT</strong>: Fast (FFT-like)</p></li>
<li><p><strong>Q-transform</strong>: Medium (adaptive windowing)</p></li>
<li><p><strong>Wavelet</strong>: Medium-High (scale convolutions)</p></li>
<li><p><strong>Cepstrum</strong>: Medium (double FFT)</p></li>
<li><p><strong>STLT</strong>: High (2D transform)</p></li>
<li><p><strong>HHT</strong>: Very High (iterative EMD)</p></li>
</ol>
</section>
<section id="Practical-Recommendations">
<h3>Practical Recommendations<a class="headerlink" href="#Practical-Recommendations" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>For routine analysis</strong>: Start with STFT</p></li>
<li><p><strong>For transient detection</strong>: Use Q-transform (standard in GW community)</p></li>
<li><p><strong>For detailed characterization</strong>: Combine multiple methods</p></li>
<li><p><strong>For publications</strong>: Show STFT + specialized method to demonstrate robustness</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Link to this heading"></a></h2>
<p>Each time-frequency method has a <strong>“winning scenario”</strong> where it provides information unavailable to STFT/Q-transform:</p>
<ul class="simple">
<li><p><strong>Wavelet</strong>: Sharp frequency trajectories for chirps</p></li>
<li><p><strong>HHT</strong>: Instantaneous frequency as single-valued curve</p></li>
<li><p><strong>STLT</strong>: Decay rates (damping) in addition to frequencies</p></li>
<li><p><strong>Cepstrum</strong>: Echo delays via quefrency peaks</p></li>
<li><p><strong>DCT</strong>: Extreme compression for smooth signals</p></li>
</ul>
<p><strong>Choose your method based on what information you need</strong>, not just “better resolution.”</p>
<p>For more details on individual methods:</p>
<ul class="simple">
<li><p><a class="reference internal" href="intro_spectrogram.html"><span class="doc">STFT/Spectrogram Tutorial</span></a></p></li>
<li><p><a class="reference internal" href="advanced_hht.html"><span class="doc">HHT Tutorial</span></a></p></li>
<li><p><a class="reference internal" href="field_advanced_integration.html"><span class="doc">Field × Advanced Analysis</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="advanced_hht.html" class="btn btn-neutral float-left" title="Hilbert-Huang Transform (HHT) 解析チュートリアル" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="time_frequency_comparison.html" class="btn btn-neutral float-right" title="Time-Frequency Methods: Comparison and Selection Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, GWexpy contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>