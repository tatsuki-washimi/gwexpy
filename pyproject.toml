[build-system]
requires = ["setuptools>=68", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "gwexpy"
version = "0.1.0"
description = "GWpy Expansions for Experiments"
readme = "README.md"
requires-python = ">=3.9"
dependencies = [
  "astropy",
  "gwpy",
  "numpy",
  "pandas",
  "scipy",
]

[project.optional-dependencies]
dev = ["pytest", "pytest-cov", "ruff", "mypy"]
torch = ["torch"]
tensorflow = ["tensorflow"]
jax = ["jax", "jaxlib"]
dask = ["dask"]
zarr = ["zarr"]
audio = ["librosa", "pydub", "torchaudio"]
data = ["xarray", "h5py", "netCDF4", "obspy", "mne", "neo"]
control = ["control"]
gpu = ["cupy"]
geophysics = ["wintools", "win2ndarray", "mth5", "mt_metadata", "mtpy"]
interop = [
    "torch", "tensorflow", "jax", "jaxlib", "dask", "zarr",
    "librosa", "pydub", "torchaudio",
    "xarray", "h5py", "netCDF4", "obspy", "mne", "neo",
    "control", "cupy",
    "wintools", "win2ndarray", "mth5", "mt_metadata", "mtpy"
]
all = [
    "torch", "tensorflow", "jax", "jaxlib", "dask", "zarr",
    "librosa", "pydub", "torchaudio",
    "xarray", "h5py", "netCDF4", "obspy", "mne", "neo",
    "control", "cupy",
    "wintools", "win2ndarray", "mth5", "mt_metadata", "mtpy"
]

[tool.setuptools.packages.find]
where = ["."]
include = ["gwexpy*"]

[tool.setuptools.package-data]
gwexpy = ["py.typed"]

[tool.pytest.ini_options]
addopts = ["-ra"]
pythonpath = ["."]
markers = [
    "freeze_time: Freeze time for testing",
    "cvmfs: Requires CVMFS available",
    "requires: Conditional dependency checks",
    "remote: Requires network access",
]
filterwarnings = [
    "ignore:.*joblib will operate in serial mode.*:UserWarning:joblib._multiprocessing_helpers",
    "ignore:Ignoring n_components with whiten=False.*:UserWarning:sklearn.decomposition._fastica",
    "ignore:xindex was given to .* will be ignored:UserWarning:gwpy.types.series",
    "ignore:Converting time units .* to GPS seconds for alignment\\.:UserWarning:gwexpy.timeseries.preprocess",
    "ignore:Support for identity-based X\\.509 credentials.*:DeprecationWarning:igwn_auth_utils.requests",
    "ignore:divisions involving a unit and a 'str' instance are deprecated.*:astropy.utils.exceptions.AstropyDeprecationWarning:gwpy.timeseries.tests.test_timeseries",
    "ignore:invalid value encountered in divide:RuntimeWarning:astropy.units.quantity",
    "ignore:invalid value encountered in divide:RuntimeWarning",
]

[tool.mypy]
python_version = "3.9"
ignore_missing_imports = true
show_error_codes = true
warn_unused_ignores = true

[tool.coverage.run]
branch = true
source = ["gwexpy"]
omit = [
    "gwexpy/**/tests/*",
    "tests/*",
]

[tool.coverage.report]
show_missing = true
skip_covered = true
fail_under = 70
