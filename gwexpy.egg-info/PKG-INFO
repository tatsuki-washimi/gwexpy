Metadata-Version: 2.4
Name: gwexpy
Version: 0.1.0
Summary: GWpy Expansions for Experiments
Requires-Python: >=3.9
Description-Content-Type: text/markdown
Requires-Dist: astropy
Requires-Dist: gwpy
Requires-Dist: numpy
Requires-Dist: pandas
Requires-Dist: scipy
Provides-Extra: dev
Requires-Dist: pytest; extra == "dev"
Provides-Extra: torch
Requires-Dist: torch; extra == "torch"
Provides-Extra: tensorflow
Requires-Dist: tensorflow; extra == "tensorflow"
Provides-Extra: jax
Requires-Dist: jax; extra == "jax"
Requires-Dist: jaxlib; extra == "jax"
Provides-Extra: dask
Requires-Dist: dask; extra == "dask"
Provides-Extra: zarr
Requires-Dist: zarr; extra == "zarr"
Provides-Extra: audio
Requires-Dist: librosa; extra == "audio"
Requires-Dist: pydub; extra == "audio"
Requires-Dist: torchaudio; extra == "audio"
Provides-Extra: data
Requires-Dist: xarray; extra == "data"
Requires-Dist: h5py; extra == "data"
Requires-Dist: netCDF4; extra == "data"
Requires-Dist: obspy; extra == "data"
Requires-Dist: mne; extra == "data"
Requires-Dist: neo; extra == "data"
Provides-Extra: control
Requires-Dist: control; extra == "control"
Provides-Extra: gpu
Requires-Dist: cupy; extra == "gpu"
Provides-Extra: geophysics
Requires-Dist: wintools; extra == "geophysics"
Requires-Dist: win2ndarray; extra == "geophysics"
Requires-Dist: mth5; extra == "geophysics"
Requires-Dist: mt_metadata; extra == "geophysics"
Requires-Dist: mtpy; extra == "geophysics"
Provides-Extra: interop
Requires-Dist: torch; extra == "interop"
Requires-Dist: tensorflow; extra == "interop"
Requires-Dist: jax; extra == "interop"
Requires-Dist: jaxlib; extra == "interop"
Requires-Dist: dask; extra == "interop"
Requires-Dist: zarr; extra == "interop"
Requires-Dist: librosa; extra == "interop"
Requires-Dist: pydub; extra == "interop"
Requires-Dist: torchaudio; extra == "interop"
Requires-Dist: xarray; extra == "interop"
Requires-Dist: h5py; extra == "interop"
Requires-Dist: netCDF4; extra == "interop"
Requires-Dist: obspy; extra == "interop"
Requires-Dist: mne; extra == "interop"
Requires-Dist: neo; extra == "interop"
Requires-Dist: control; extra == "interop"
Requires-Dist: cupy; extra == "interop"
Requires-Dist: wintools; extra == "interop"
Requires-Dist: win2ndarray; extra == "interop"
Requires-Dist: mth5; extra == "interop"
Requires-Dist: mt_metadata; extra == "interop"
Requires-Dist: mtpy; extra == "interop"
Provides-Extra: all
Requires-Dist: torch; extra == "all"
Requires-Dist: tensorflow; extra == "all"
Requires-Dist: jax; extra == "all"
Requires-Dist: jaxlib; extra == "all"
Requires-Dist: dask; extra == "all"
Requires-Dist: zarr; extra == "all"
Requires-Dist: librosa; extra == "all"
Requires-Dist: pydub; extra == "all"
Requires-Dist: torchaudio; extra == "all"
Requires-Dist: xarray; extra == "all"
Requires-Dist: h5py; extra == "all"
Requires-Dist: netCDF4; extra == "all"
Requires-Dist: obspy; extra == "all"
Requires-Dist: mne; extra == "all"
Requires-Dist: neo; extra == "all"
Requires-Dist: control; extra == "all"
Requires-Dist: cupy; extra == "all"
Requires-Dist: wintools; extra == "all"
Requires-Dist: win2ndarray; extra == "all"
Requires-Dist: mth5; extra == "all"
Requires-Dist: mt_metadata; extra == "all"
Requires-Dist: mtpy; extra == "all"

# gwexpy: GWpy Expansions for Experiments

**gwexpy** is an (unofficial) extension library for **GWpy**, designed to facilitate advanced time-series analysis, matrix operations, and signal processing for experimental physics and gravitational wave data analysis. It builds upon GWpy's core data objects (`TimeSeries`, `FrequencySeries`) and introduces high-level containers and methods for multivariate analysis and interoperability with the broader Python scientific ecosystem.

## Key Features

### 1. Advanced Containers
- **`TimeSeriesMatrix`**: A 3D container `(channels, 1, time)` for handling multi-channel time-series data with shared time axes. Supports element-wise operations, slicing, PCA/ICA decomposition, and bulk processing.
- **`FrequencySeriesMatrix`**: A matrix container for frequency-domain data, ideal for representing Transfer Functions, CSD, and Coherence matrices.
- **`TimePlaneTransform`**: A container for 2D time-frequency representations (like STLT output), supporting interpolation along the time axis.

### 2. Spectral Analysis Extensions
- **Spectral Matrices**: Easily compute Cross-Spectral Density (CSD) and Coherence matrices for entire collections.
  - `TimeSeriesDict.csd_matrix()` / `coherence_matrix()`
  - `TimeSeriesList.csd_matrix()` / `coherence_matrix()`
- **Extended FFT & Transfer Functions**:
  - `TimeSeries.fft(mode="transient")`: Transient-friendly FFT with padding options (zero, reflect).
  - `TimeSeries.transfer_function()`: Supports 'gwpy' (Welch), 'fft' (Direct ratio), and 'auto' modes.

### 3. Signal Transforms & Peak Finding
- **Short-Time Local Transform (STLT)**: `ts.stlt()` creates a time-frequency representation tailored for local stationarity analysis.
- **Peak Finding**: `ts.find_peaks()` wraps `scipy.signal.find_peaks` with unit-aware parameters (height, distance, width in physical units).
- **HHT**: Hilbert-Huang Transform support (EMD + Hilbert Spectrum).
- **Other Transforms**: Laplace Transform, DCT, Cepstrum, CWT.

### 4. Preprocessing & Decomposition
- **Alignment**: `align_timeseries_collection` to synchronize varying start times and sample rates.
- **Imputation**: `impute_timeseries` / `TimeSeries.impute()` for handling gaps.
- **Standardization & Whitening**: transformation methods for `TimeSeries` and `TimeSeriesMatrix`.
- **Decomposition**: Integrated **PCA** and **ICA** methods for `TimeSeriesMatrix`.

### 5. Advanced Statistics
- **ARIMA**: Forecasting and residual analysis.
- **Hurst Exponent**: Global and local Hurst exponent estimation.

---

## Installation

```bash
# Standard installation
pip install .

# Install with ALL optional dependencies (Recommended)
pip install ".[all]"

# Install specific features
pip install ".[interop]"     # All interoperability features
pip install ".[geophysics]"  # Obspy, MTh5, etc.
pip install ".[torch]"       # PyTorch support
pip install ".[audio]"       # Librosa, Pydub, Torchaudio
```
*(Note: Core dependencies include `gwpy`, `astropy`, `numpy`, `scipy`. Some features require `torch`, `tensorflow`, `dask`, `zarr`, `pydub`, `librosa`, etc.)*

---

## Usage Examples

### 1. Interoperability (Deep Learning & Big Data)
gwexpy provides seamless conversion to/from major data science frameworks:

```python
from gwexpy.interop import to_torch, to_tf, to_jax, to_dask, to_zarr
ts = ... # TimeSeries

# Deep Learning Frameworks
tensor_pt = to_torch(ts)      # PyTorch Tensor
tensor_tf = to_tf(ts)         # TensorFlow Tensor
tensor_jax = to_jax(ts)       # JAX Array
tensor_cupy = to_cupy(ts)     # CuPy Array

# Big Data & Storage
dask_arr = to_dask(ts, chunksize=1000) # Dask Array
zarr_arr = to_zarr(ts, path="data.zarr") # Save to Zarr

# Audio & Other Domains
# Supports: Librosa (standard numpy), Pydub (AudioSegment), ObsPy (Trace), MNE, Neo
from gwexpy.interop import to_pydub, to_obspy_trace
audio_seg = to_pydub(ts)
trace = to_obspy_trace(ts)
```

### 2. TimeSeriesMatrix & Decomposition
```python
import numpy as np
from gwexpy.timeseries import TimeSeries, TimeSeriesMatrix
from astropy import units as u

# Create a TimeSeriesMatrix from a list of Series
t = np.linspace(0, 10, 1000) * u.s
s1 = TimeSeries(np.sin(2*np.pi*1*t), times=t, name="Ch1")
s2 = TimeSeries(np.cos(2*np.pi*1*t) + 0.5*np.random.randn(1000), times=t, name="Ch2")
mat = TimeSeriesMatrix.from_list([s1, s2])

# Preprocessing & Decomposition
mat_clean = mat.impute(method="interpolate").standardize()
scores, model = mat_clean.pca(n_components=2, return_model=True)
sources = mat_clean.ica(n_components=2)
```

### 3. Peak Finding
```python
# Find peaks with physical unit constraints
peaks, props = s2.find_peaks(
    height=0.5,           # Minimum height (unit of data)
    distance=0.1 * u.s,   # Minimum distance between peaks
    width=0.05 * u.s      # Minimum width
)
peaks.plot(style='o')
```

### 4. Signal Transforms (STLT & HHT)
```python
# Short-Time Local Transform
stlt_res = s1.stlt(window='2s', stride='0.5s') 
# Returns TimePlaneTransform (interpolate-able)
val_at_5s = stlt_res.at_time(5*u.s, method="linear")

# Hilbert-Huang Transform (requires EMD-signal)
try:
    hht_spec = s1.hht(method="eemd", output="spectrogram")
    hht_spec.plot()
except ImportError:
    print("Install EMD-signal for HHT")
```

### 5. Torch Dataset Helper
```python
from gwexpy.interop import to_torch_dataset, to_torch_dataloader

ds = to_torch_dataset(s1, window=256, stride=128)
loader = to_torch_dataloader(ds, batch_size=8, shuffle=True)
for batch in loader:
    # batch: (B, C, window)
    pass
```

## Contributing
Contributions are welcome! Please open issues or submit PRs for new features or bug fixes.
