

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>gwexpy.timeseries.collections &mdash; gwexpy  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            gwexpy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Detailed Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/en/index.html">Detailed Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">gwexpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">gwexpy.timeseries.collections</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for gwexpy.timeseries.collections</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">astropy</span><span class="w"> </span><span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">scipy.signal</span>  <span class="c1"># noqa: F401 - availability check</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">pass</span>  <span class="c1"># scipy is optional dependency for gwpy but required here for hilbert</span>


<span class="kn">from</span><span class="w"> </span><span class="nn">gwpy.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeries</span> <span class="k">as</span> <span class="n">BaseTimeSeries</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gwpy.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesDict</span> <span class="k">as</span> <span class="n">BaseTimeSeriesDict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gwpy.timeseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesList</span> <span class="k">as</span> <span class="n">BaseTimeSeriesList</span>

<span class="c1"># --- Monkey Patch TimeSeriesDict ---</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.types.mixin</span><span class="w"> </span><span class="kn">import</span> <span class="n">PhaseMethodsMixin</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.spectral</span><span class="w"> </span><span class="kn">import</span> <span class="n">coherence_matrix_from_collection</span><span class="p">,</span> <span class="n">csd_matrix_from_collection</span>


<div class="viewcode-block" id="TimeSeriesDict">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TimeSeriesDict</span><span class="p">(</span><span class="n">PhaseMethodsMixin</span><span class="p">,</span> <span class="n">BaseTimeSeriesDict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dictionary of TimeSeries objects.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="TimeSeriesDict.asfreq">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.asfreq">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">asfreq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rule</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply asfreq to each TimeSeries in the dict.</span>
<span class="sd">        Returns a new TimeSeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.resample">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.resample">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">resample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resample items in the TimeSeriesDict.</span>
<span class="sd">        In-place operation (updates the dict contents).</span>

<span class="sd">        If rate is time-like, performs time-bin resampling.</span>
<span class="sd">        Otherwise performs signal processing resampling (gwpy&#39;s native behavior).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">is_time_bin</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">is_time_bin</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">)</span> <span class="ow">and</span> <span class="n">rate</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">physical_type</span> <span class="o">==</span> <span class="s2">&quot;time&quot;</span><span class="p">:</span>
            <span class="n">is_time_bin</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">is_time_bin</span><span class="p">:</span>
            <span class="c1"># Time-bin logic: replace items in-place</span>
            <span class="c1"># We can&#39;t strictly modify the objects in-place easily</span>
            <span class="c1"># (asfreq/resample return new objects usually),</span>
            <span class="c1"># so we replace the values in the dict.</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Native gwpy resample (signal processing)</span>
            <span class="c1"># gwpy&#39;s TimeSeriesDict.resample is in-place</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.hilbert">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.hilbert">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">hilbert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply Hilbert transform to each item.&quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">hilbert</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.envelope">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.envelope">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply envelope to each item.&quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">envelope</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.instantaneous_phase">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.instantaneous_phase">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">instantaneous_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply instantaneous_phase to each item.&quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">instantaneous_phase</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span>

        <span class="k">return</span> <span class="n">new_dict</span></div>


    <span class="c1"># ===============================</span>
    <span class="c1"># P2 Methods (Domain Specific)</span>
    <span class="c1"># ===============================</span>

<div class="viewcode-block" id="TimeSeriesDict.to_mne">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.to_mne">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_mne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to mne.io.RawArray.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.interop</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_mne_rawarray</span>

        <span class="k">return</span> <span class="n">to_mne_rawarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="n">info</span><span class="p">,</span> <span class="n">picks</span><span class="o">=</span><span class="n">picks</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.from_mne">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.from_mne">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_mne</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">raw</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">unit_map</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create from mne.io.Raw.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.interop</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_mne_raw</span>

        <span class="k">return</span> <span class="n">from_mne_raw</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">raw</span><span class="p">,</span> <span class="n">unit_map</span><span class="o">=</span><span class="n">unit_map</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.from_control">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.from_control">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_control</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create TimeSeriesDict from python-control TimeResponseData.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        response : control.TimeResponseData</span>
<span class="sd">            The simulation result from python-control.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Additional arguments passed to the TimeSeries constructor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TimeSeriesDict</span>
<span class="sd">            The converted time-domain data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.interop</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_control_response</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">from_control_response</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="c1"># Wrap in a Dictionary if it isn&#39;t one already</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">)</span>
            <span class="n">obj</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="TimeSeriesDict.radian">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.radian">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">radian</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute instantaneous phase (in radians) of each item.&quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">radian</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.degree">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.degree">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute instantaneous phase (in degrees) of each item.&quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


    <span class="c1"># phase() and angle() are provided by PhaseMethodsMixin</span>

<div class="viewcode-block" id="TimeSeriesDict.unwrap_phase">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.unwrap_phase">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">unwrap_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply unwrap_phase to each item.&quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">unwrap_phase</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.instantaneous_frequency">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.instantaneous_frequency">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">instantaneous_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply instantaneous_frequency to each item.&quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">instantaneous_frequency</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.mix_down">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.mix_down">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">mix_down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply mix_down to each item.&quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">mix_down</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.baseband">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.baseband">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">baseband</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply baseband to each item.&quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">baseband</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.heterodyne">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.heterodyne">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">heterodyne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply heterodyne to each item.&quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">heterodyne</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.lock_in">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.lock_in">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">lock_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply lock_in to each item.</span>
<span class="sd">        Returns TimeSeriesDict (if output=&#39;complex&#39;) or tuple of TimeSeriesDicts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># We need to know the output structure (tuple vs single)</span>
        <span class="c1"># Peek first item</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">first_res</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">lock_in</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first_res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="c1"># Tuple return (e.g. mag, phase or i, q)</span>
            <span class="c1"># Assume logic dictates uniform return type</span>
            <span class="n">dict_tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">first_res</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">lock_in</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
                    <span class="n">dict_tuple</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="k">return</span> <span class="n">dict_tuple</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Single return</span>
            <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">first_res</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">lock_in</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.csd_matrix">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.csd_matrix">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">csd_matrix</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">fftlength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">overlap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">hermitian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">include_diagonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute Cross-Spectral Density matrix for all pairs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : TimeSeriesDict or TimeSeriesList, optional</span>
<span class="sd">            Another collection for cross-CSD. If None, compute self-CSD matrix.</span>
<span class="sd">        fftlength : float, optional</span>
<span class="sd">            FFT length in seconds.</span>
<span class="sd">        overlap : float, optional</span>
<span class="sd">            Overlap between segments in seconds.</span>
<span class="sd">        window : str, optional</span>
<span class="sd">            Window function name (default &#39;hann&#39;).</span>
<span class="sd">        hermitian : bool, optional</span>
<span class="sd">            If True, exploit Hermitian symmetry (default True).</span>
<span class="sd">        include_diagonal : bool, optional</span>
<span class="sd">            Must be True for CSD matrices; False raises ValueError because the</span>
<span class="sd">            diagonal is always the PSD.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        FrequencySeriesMatrix</span>
<span class="sd">            The CSD matrix.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The diagonal of a self-CSD matrix is always computed as the PSD. Any</span>
<span class="sd">        uncomputed elements are represented as complex NaN. The frequency axis</span>
<span class="sd">        is taken from the first computed element without alignment/truncation;</span>
<span class="sd">        dt and fftlength consistency is enforced before computation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">csd_matrix_from_collection</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
            <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
            <span class="n">hermitian</span><span class="o">=</span><span class="n">hermitian</span><span class="p">,</span>
            <span class="n">include_diagonal</span><span class="o">=</span><span class="n">include_diagonal</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.coherence_matrix">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.coherence_matrix">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">coherence_matrix</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">fftlength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">overlap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">symmetric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">include_diagonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">diagonal_value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute coherence matrix for all pairs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : TimeSeriesDict or TimeSeriesList, optional</span>
<span class="sd">            Another collection for cross-coherence.</span>
<span class="sd">        fftlength : float, optional</span>
<span class="sd">            FFT length in seconds.</span>
<span class="sd">        overlap : float, optional</span>
<span class="sd">            Overlap between segments in seconds.</span>
<span class="sd">        window : str, optional</span>
<span class="sd">            Window function name (default &#39;hann&#39;).</span>
<span class="sd">        symmetric : bool, optional</span>
<span class="sd">            If True, exploit symmetry (default True).</span>
<span class="sd">        include_diagonal : bool, optional</span>
<span class="sd">            Whether to include diagonal elements (default True).</span>
<span class="sd">        diagonal_value : float, optional</span>
<span class="sd">            Value for diagonal elements (default 1.0).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        FrequencySeriesMatrix</span>
<span class="sd">            The coherence matrix.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If include_diagonal is True and diagonal_value is not None, the</span>
<span class="sd">        diagonal is filled with that value without computation. If</span>
<span class="sd">        diagonal_value is None, the diagonal coherence is computed. Uncomputed</span>
<span class="sd">        elements are represented as NaN. The frequency axis is taken from the</span>
<span class="sd">        first computed element without alignment/truncation; dt and fftlength</span>
<span class="sd">        consistency is enforced before computation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">coherence_matrix_from_collection</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
            <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
            <span class="n">symmetric</span><span class="o">=</span><span class="n">symmetric</span><span class="p">,</span>
            <span class="n">include_diagonal</span><span class="o">=</span><span class="n">include_diagonal</span><span class="p">,</span>
            <span class="n">diagonal_value</span><span class="o">=</span><span class="n">diagonal_value</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.csd">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.csd">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">csd</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">fftlength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">overlap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">hermitian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">include_diagonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute CSD for each element or as a matrix depending on `other`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">other</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">csd_matrix</span><span class="p">(</span>
                <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
                <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
                <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
                <span class="n">hermitian</span><span class="o">=</span><span class="n">hermitian</span><span class="p">,</span>
                <span class="n">include_diagonal</span><span class="o">=</span><span class="n">include_diagonal</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BaseTimeSeries</span><span class="p">):</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.frequencyseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrequencySeriesDict</span>

            <span class="n">new_dict</span> <span class="o">=</span> <span class="n">FrequencySeriesDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">csd</span><span class="p">(</span>
                    <span class="n">other</span><span class="p">,</span> <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">new_dict</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">BaseTimeSeriesList</span><span class="p">,</span> <span class="n">BaseTimeSeriesDict</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">csd_matrix_from_collection</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">other</span><span class="p">,</span>
                <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
                <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
                <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
                <span class="n">hermitian</span><span class="o">=</span><span class="n">hermitian</span><span class="p">,</span>
                <span class="n">include_diagonal</span><span class="o">=</span><span class="n">include_diagonal</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;other must be TimeSeries, TimeSeriesList/Dict, or None/&#39;self&#39;&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.coherence">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.coherence">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">coherence</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">fftlength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">overlap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">symmetric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">include_diagonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">diagonal_value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute coherence for each element or as a matrix depending on `other`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">other</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_matrix</span><span class="p">(</span>
                <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
                <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
                <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
                <span class="n">symmetric</span><span class="o">=</span><span class="n">symmetric</span><span class="p">,</span>
                <span class="n">include_diagonal</span><span class="o">=</span><span class="n">include_diagonal</span><span class="p">,</span>
                <span class="n">diagonal_value</span><span class="o">=</span><span class="n">diagonal_value</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BaseTimeSeries</span><span class="p">):</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.frequencyseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrequencySeriesDict</span>

            <span class="n">new_dict</span> <span class="o">=</span> <span class="n">FrequencySeriesDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">coherence</span><span class="p">(</span>
                    <span class="n">other</span><span class="p">,</span> <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">new_dict</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">BaseTimeSeriesList</span><span class="p">,</span> <span class="n">BaseTimeSeriesDict</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">coherence_matrix_from_collection</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">other</span><span class="p">,</span>
                <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
                <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
                <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
                <span class="n">symmetric</span><span class="o">=</span><span class="n">symmetric</span><span class="p">,</span>
                <span class="n">include_diagonal</span><span class="o">=</span><span class="n">include_diagonal</span><span class="p">,</span>
                <span class="n">diagonal_value</span><span class="o">=</span><span class="n">diagonal_value</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;other must be TimeSeries, TimeSeriesList/Dict, or None/&#39;self&#39;&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.psd">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.psd">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">psd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute Power Spectral Density for each TimeSeries in the dict.</span>
<span class="sd">        Returns a FrequencySeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.frequencyseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrequencySeriesDict</span>

        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">FrequencySeriesDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.asd">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.asd">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">asd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute Amplitude Spectral Density for each TimeSeries in the dict.</span>
<span class="sd">        Returns a FrequencySeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.frequencyseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrequencySeriesDict</span>

        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">FrequencySeriesDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">asd</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.spectrogram">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.spectrogram">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">spectrogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute spectrogram for each TimeSeries in the dict.</span>
<span class="sd">        Returns a SpectrogramDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.spectrogram</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectrogramDict</span>

        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">SpectrogramDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.spectrogram2">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.spectrogram2">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">spectrogram2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute spectrogram2 for each TimeSeries in the dict.</span>
<span class="sd">        Returns a SpectrogramDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.spectrogram</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectrogramDict</span>

        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">SpectrogramDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">spectrogram2</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.q_transform">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.q_transform">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">q_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute Q-transform for each TimeSeries in the dict.</span>
<span class="sd">        Returns a SpectrogramDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.spectrogram</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectrogramDict</span>

        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">SpectrogramDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">q_transform</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


    <span class="c1"># ===============================</span>
    <span class="c1"># Interoperability Methods (P0)</span>
    <span class="c1"># ===============================</span>

<div class="viewcode-block" id="TimeSeriesDict.to_pandas">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.to_pandas">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to pandas.DataFrame.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.interop</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_pandas_dataframe</span>

        <span class="k">return</span> <span class="n">to_pandas_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.from_pandas">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.from_pandas">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_pandas</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">unit_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create TimeSeriesDict from pandas.DataFrame.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.interop</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_pandas_dataframe</span>

        <span class="k">return</span> <span class="n">from_pandas_dataframe</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">unit_map</span><span class="o">=</span><span class="n">unit_map</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.to_polars">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.to_polars">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_polars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_column</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s2">&quot;datetime&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to polars.DataFrame.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.interop</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_polars_dict</span>

        <span class="k">return</span> <span class="n">to_polars_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_column</span><span class="o">=</span><span class="n">time_column</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="n">time_unit</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.from_polars">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.from_polars">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_polars</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">time_column</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">unit_map</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create TimeSeriesDict from polars.DataFrame.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.interop</span><span class="w"> </span><span class="kn">import</span> <span class="n">from_polars_dict</span>

        <span class="k">return</span> <span class="n">from_polars_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">index_column</span><span class="o">=</span><span class="n">time_column</span><span class="p">,</span> <span class="n">unit_map</span><span class="o">=</span><span class="n">unit_map</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.to_tmultigraph">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.to_tmultigraph">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_tmultigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to ROOT TMultiGraph.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.interop</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_tmultigraph</span>

        <span class="k">return</span> <span class="n">to_tmultigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.write">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.write">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s2">&quot;root&quot;</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">target</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.root&quot;</span><span class="p">)):</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.interop.root_</span><span class="w"> </span><span class="kn">import</span> <span class="n">write_root_file</span>

            <span class="k">return</span> <span class="n">write_root_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.plot">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.plot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot all series. Delegates to gwexpy.plot.Plot.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.plot</span><span class="w"> </span><span class="kn">import</span> <span class="n">Plot</span>

        <span class="k">return</span> <span class="n">Plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.plot_all">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.plot_all">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for plot(). Plots all series.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.impute">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.impute">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">impute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;interpolate&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">max_gap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply impute to each item.&quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">impute</span><span class="p">(</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">max_gap</span><span class="o">=</span><span class="n">max_gap</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.rolling_mean">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.rolling_mean">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rolling_mean</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">window</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s2">&quot;omit&quot;</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">ignore_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply rolling mean to each item.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries.rolling</span><span class="w"> </span><span class="kn">import</span> <span class="n">rolling_mean</span>

        <span class="k">return</span> <span class="n">rolling_mean</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">window</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">min_count</span><span class="o">=</span><span class="n">min_count</span><span class="p">,</span>
            <span class="n">nan_policy</span><span class="o">=</span><span class="n">nan_policy</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
            <span class="n">ignore_nan</span><span class="o">=</span><span class="n">ignore_nan</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.rolling_std">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.rolling_std">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rolling_std</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">window</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s2">&quot;omit&quot;</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">ignore_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply rolling std to each item.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries.rolling</span><span class="w"> </span><span class="kn">import</span> <span class="n">rolling_std</span>

        <span class="k">return</span> <span class="n">rolling_std</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">window</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">min_count</span><span class="o">=</span><span class="n">min_count</span><span class="p">,</span>
            <span class="n">nan_policy</span><span class="o">=</span><span class="n">nan_policy</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
            <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">,</span>
            <span class="n">ignore_nan</span><span class="o">=</span><span class="n">ignore_nan</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.rolling_median">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.rolling_median">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rolling_median</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">window</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s2">&quot;omit&quot;</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">ignore_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply rolling median to each item.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries.rolling</span><span class="w"> </span><span class="kn">import</span> <span class="n">rolling_median</span>

        <span class="k">return</span> <span class="n">rolling_median</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">window</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">min_count</span><span class="o">=</span><span class="n">min_count</span><span class="p">,</span>
            <span class="n">nan_policy</span><span class="o">=</span><span class="n">nan_policy</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
            <span class="n">ignore_nan</span><span class="o">=</span><span class="n">ignore_nan</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.rolling_min">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.rolling_min">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rolling_min</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">window</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s2">&quot;omit&quot;</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">ignore_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply rolling min to each item.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries.rolling</span><span class="w"> </span><span class="kn">import</span> <span class="n">rolling_min</span>

        <span class="k">return</span> <span class="n">rolling_min</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">window</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">min_count</span><span class="o">=</span><span class="n">min_count</span><span class="p">,</span>
            <span class="n">nan_policy</span><span class="o">=</span><span class="n">nan_policy</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
            <span class="n">ignore_nan</span><span class="o">=</span><span class="n">ignore_nan</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.rolling_max">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.rolling_max">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rolling_max</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">window</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s2">&quot;omit&quot;</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">ignore_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply rolling max to each item.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries.rolling</span><span class="w"> </span><span class="kn">import</span> <span class="n">rolling_max</span>

        <span class="k">return</span> <span class="n">rolling_max</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">window</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">min_count</span><span class="o">=</span><span class="n">min_count</span><span class="p">,</span>
            <span class="n">nan_policy</span><span class="o">=</span><span class="n">nan_policy</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
            <span class="n">ignore_nan</span><span class="o">=</span><span class="n">ignore_nan</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.to_matrix">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.to_matrix">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;intersection&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert dictionary to TimeSeriesMatrix with alignment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries.preprocess</span><span class="w"> </span><span class="kn">import</span> <span class="n">align_timeseries_collection</span>

        <span class="c1"># Ensure consistent order (keys sorted) or specific</span>
        <span class="c1"># Dicts are ordered in modern python but keys() usually safe</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">series_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]</span>

        <span class="n">vals</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">align_timeseries_collection</span><span class="p">(</span>
            <span class="n">series_list</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">align</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

        <span class="c1"># SeriesMatrix expects 3D usually (rows, cols, time) or checks last axis</span>
        <span class="c1"># vals: (samples, channels).</span>
        <span class="c1"># We create (channels, 1, samples).</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">.matrix</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesMatrix</span>

        <span class="n">matrix</span> <span class="o">=</span> <span class="n">TimeSeriesMatrix</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span>
            <span class="c1"># meta might contain channel_names from original list (names of TS objects)</span>
            <span class="c1"># But converting dict to matrix usually implies keys become channel names?</span>
            <span class="c1"># User requirement: &quot;preserve labels&quot;</span>
            <span class="c1"># TimeSeries from dict usually inherit name from key if created via read?</span>
            <span class="c1"># Not always. We should force keys as names?</span>
            <span class="c1"># &quot;Must preserve channel ordering from input.&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Assign channel names from keys</span>
        <span class="n">matrix</span><span class="o">.</span><span class="n">channel_names</span> <span class="o">=</span> <span class="n">keys</span>
        <span class="k">return</span> <span class="n">matrix</span></div>


    <span class="c1"># ===============================</span>
    <span class="c1"># Batch Processing Methods (P1)</span>
    <span class="c1"># ===============================</span>

    <span class="c1"># --- Waveform Operations ---</span>

<div class="viewcode-block" id="TimeSeriesDict.crop">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.crop">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">crop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Crop each TimeSeries in the dict.</span>
<span class="sd">        Accepts any time format supported by gwexpy.time.to_gps (str, datetime, pandas, obspy, etc).</span>
<span class="sd">        Returns a new TimeSeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.time</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_gps</span>

        <span class="c1"># Convert inputs to GPS if provided</span>
        <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">to_gps</span><span class="p">(</span><span class="n">start</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">to_gps</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>

        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.append">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.append">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Append another mapping of TimeSeries or a single TimeSeries to each item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BaseTimeSeries</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">ts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="c1"># If &#39;copy&#39; key is present in &#39;other&#39; (can happen with some readers),</span>
        <span class="c1"># it will cause super().append to fail if &#39;copy&#39; is not a TimeSeries.</span>
        <span class="c1"># We should filter it out if it&#39;s not a TimeSeries.</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;pop&quot;</span><span class="p">)</span>
            <span class="ow">and</span> <span class="s2">&quot;copy&quot;</span> <span class="ow">in</span> <span class="n">other</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="s2">&quot;copy&quot;</span><span class="p">],</span> <span class="n">BaseTimeSeries</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">other</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;copy&quot;</span><span class="p">)</span>

        <span class="c1"># Ensure we don&#39;t pass &#39;copy&#39; twice if it&#39;s already in kwargs</span>
        <span class="k">if</span> <span class="s2">&quot;copy&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">copy</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;copy&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.prepend">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.prepend">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepend to each TimeSeries in the dict (in-place).</span>
<span class="sd">        Returns self.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">prepend</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>


    <span class="c1"># def update(self, *args, **kwargs) -&gt; &quot;TimeSeriesDict&quot;:</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Update each TimeSeries in the dict (in-place).</span>
    <span class="c1">#     Returns self.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     for ts in self.values():</span>
    <span class="c1">#         ts.update(*args, **kwargs)</span>
    <span class="c1">#     return self</span>

<div class="viewcode-block" id="TimeSeriesDict.shift">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.shift">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shift each TimeSeries in the dict.</span>
<span class="sd">        Returns a new TimeSeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.gate">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.gate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">gate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gate each TimeSeries in the dict.</span>
<span class="sd">        Returns a new TimeSeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">gate</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.mask">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.mask">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mask each TimeSeries in the dict.</span>
<span class="sd">        Returns a new TimeSeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


    <span class="c1"># --- Signal Processing ---</span>

<div class="viewcode-block" id="TimeSeriesDict.decimate">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.decimate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">decimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Decimate each TimeSeries in the dict.</span>
<span class="sd">        Returns a new TimeSeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">decimate</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.filter">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.filter">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter each TimeSeries in the dict.</span>
<span class="sd">        Returns a new TimeSeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.whiten">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.whiten">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">whiten</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whiten each TimeSeries in the dict.</span>
<span class="sd">        Returns a new TimeSeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">whiten</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.notch">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.notch">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">notch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Notch filter each TimeSeries in the dict.</span>
<span class="sd">        Returns a new TimeSeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">notch</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.zpk">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.zpk">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">zpk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply ZPK filter to each TimeSeries in the dict.</span>
<span class="sd">        Returns a new TimeSeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">zpk</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.detrend">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.detrend">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">detrend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detrend each TimeSeries in the dict.</span>
<span class="sd">        Returns a new TimeSeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.taper">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.taper">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">taper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesDict&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Taper each TimeSeries in the dict.</span>
<span class="sd">        Returns a new TimeSeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">taper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


    <span class="c1"># --- Spectral Conversion ---</span>

<div class="viewcode-block" id="TimeSeriesDict.fft">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.fft">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">fft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply FFT to each TimeSeries in the dict.</span>
<span class="sd">        Returns a FrequencySeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.frequencyseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrequencySeriesDict</span>

        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">FrequencySeriesDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="TimeSeriesDict.average_fft">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.average_fft">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">average_fft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply averge_fft to each TimeSeries in the dict.</span>
<span class="sd">        Returns a FrequencySeriesDict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.frequencyseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrequencySeriesDict</span>

        <span class="n">new_dict</span> <span class="o">=</span> <span class="n">FrequencySeriesDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">average_fft</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


    <span class="c1"># --- Statistics &amp; Measurements ---</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_scalar_or_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal: apply a method that can return TimeSeries or scalar.</span>
<span class="sd">        If TimeSeries -&gt; return TimeSeriesDict.</span>
<span class="sd">        If scalar -&gt; return pandas.Series.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

        <span class="n">results</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">is_ts</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">first</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">first</span><span class="p">:</span>
                <span class="n">first</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="c1"># Check for TimeSeries-like structure</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;dt&quot;</span><span class="p">):</span>
                    <span class="n">is_ts</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">is_ts</span><span class="p">:</span>
                <span class="c1"># Ensure consistency</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;dt&quot;</span><span class="p">)):</span>
                    <span class="c1"># Mixed types not supported cleanly here, defaulting to dict of objects</span>
                    <span class="k">pass</span>

            <span class="n">results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>

        <span class="k">if</span> <span class="n">is_ts</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">results</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<div class="viewcode-block" id="TimeSeriesDict.value_at">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.value_at">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">value_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get value at a specific time for each TimeSeries.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_scalar_or_map</span><span class="p">(</span><span class="s2">&quot;value_at&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.is_contiguous">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.is_contiguous">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_contiguous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check contiguity with another object for each TimeSeries.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_scalar_or_map</span><span class="p">(</span><span class="s2">&quot;is_contiguous&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.skewness">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.skewness">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">skewness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute skewness. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">skewness</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.kurtosis">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.kurtosis">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">kurtosis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute kurtosis. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.mean">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.mean">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute mean. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.std">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.std">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">std</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute standard deviation. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.rms">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.rms">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute root-mean-square. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">rms</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.min">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.min">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute minimum. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.max">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.max">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute maximum. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.correlation">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.correlation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">correlation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute correlation. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.mic">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.mic">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">mic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute MIC. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">mic</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.distance_correlation">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.distance_correlation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">distance_correlation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute distance correlation. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">distance_correlation</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.pcc">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.pcc">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pcc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute Pearson correlation. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">pcc</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.ktau">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.ktau">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">ktau</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute Kendall&#39;s tau. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">ktau</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="c1"># --- State Analysis ---</span>

<div class="viewcode-block" id="TimeSeriesDict.state_segments">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.state_segments">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">state_segments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run state_segments on each item (returns Series of SegmentLists).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_scalar_or_map</span><span class="p">(</span><span class="s2">&quot;state_segments&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="c1"># --- Multivariate ---</span>

<div class="viewcode-block" id="TimeSeriesDict.pca">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.pca">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pca</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform PCA decomposition across channels.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesDict.ica">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesDict.ica">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">ica</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform ICA decomposition across channels.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">ica</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TimeSeriesList">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TimeSeriesList</span><span class="p">(</span><span class="n">PhaseMethodsMixin</span><span class="p">,</span> <span class="n">BaseTimeSeriesList</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List of TimeSeries objects.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="TimeSeriesList.csd_matrix">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.csd_matrix">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">csd_matrix</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">fftlength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">overlap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">hermitian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">include_diagonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute Cross Spectral Density Matrix.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : TimeSeriesDict or TimeSeriesList, optional</span>
<span class="sd">            Other collection for cross-CSD.</span>
<span class="sd">        fftlength, overlap, window :</span>
<span class="sd">            See TimeSeries.csd() arguments.</span>
<span class="sd">        hermitian : bool, default=True</span>
<span class="sd">            If True and other is None, compute only upper triangle and conjugate fill lower.</span>
<span class="sd">        include_diagonal : bool, default=True</span>
<span class="sd">            Must be True for CSD matrices; False raises ValueError because the</span>
<span class="sd">            diagonal is always the PSD.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        FrequencySeriesMatrix</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The diagonal of a self-CSD matrix is always computed as the PSD. Any</span>
<span class="sd">        uncomputed elements are represented as complex NaN. The frequency axis</span>
<span class="sd">        is taken from the first computed element without alignment/truncation;</span>
<span class="sd">        dt and fftlength consistency is enforced before computation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">csd_matrix_from_collection</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
            <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
            <span class="n">hermitian</span><span class="o">=</span><span class="n">hermitian</span><span class="p">,</span>
            <span class="n">include_diagonal</span><span class="o">=</span><span class="n">include_diagonal</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.coherence_matrix">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.coherence_matrix">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">coherence_matrix</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">fftlength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">overlap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">symmetric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">include_diagonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">diagonal_value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute Coherence Matrix.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : TimeSeriesDict or TimeSeriesList, optional</span>
<span class="sd">            Other collection.</span>
<span class="sd">        fftlength, overlap, window :</span>
<span class="sd">            See TimeSeries.coherence().</span>
<span class="sd">        symmetric : bool, default=True</span>
<span class="sd">            If True and other is None, compute only upper triangle and copy to lower.</span>
<span class="sd">        include_diagonal : bool, default=True</span>
<span class="sd">            Include diagonal.</span>
<span class="sd">        diagonal_value : float or None, default=1.0</span>
<span class="sd">            Value to fill diagonal if include_diagonal is True. If None, compute diagonal coherence.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        FrequencySeriesMatrix</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If include_diagonal is True and diagonal_value is not None, the</span>
<span class="sd">        diagonal is filled with that value without computation. If</span>
<span class="sd">        diagonal_value is None, the diagonal coherence is computed. Uncomputed</span>
<span class="sd">        elements are represented as NaN. The frequency axis is taken from the</span>
<span class="sd">        first computed element without alignment/truncation; dt and fftlength</span>
<span class="sd">        consistency is enforced before computation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">coherence_matrix_from_collection</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
            <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
            <span class="n">symmetric</span><span class="o">=</span><span class="n">symmetric</span><span class="p">,</span>
            <span class="n">include_diagonal</span><span class="o">=</span><span class="n">include_diagonal</span><span class="p">,</span>
            <span class="n">diagonal_value</span><span class="o">=</span><span class="n">diagonal_value</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.csd">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.csd">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">csd</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">fftlength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">overlap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">hermitian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">include_diagonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute CSD for each element or as a matrix depending on `other`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">other</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">csd_matrix</span><span class="p">(</span>
                <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
                <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
                <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
                <span class="n">hermitian</span><span class="o">=</span><span class="n">hermitian</span><span class="p">,</span>
                <span class="n">include_diagonal</span><span class="o">=</span><span class="n">include_diagonal</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BaseTimeSeries</span><span class="p">):</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.frequencyseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrequencySeriesList</span>

            <span class="n">new_list</span> <span class="o">=</span> <span class="n">FrequencySeriesList</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">new_list</span><span class="p">,</span>
                    <span class="n">ts</span><span class="o">.</span><span class="n">csd</span><span class="p">(</span>
                        <span class="n">other</span><span class="p">,</span>
                        <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
                        <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
                        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">new_list</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">BaseTimeSeriesList</span><span class="p">,</span> <span class="n">BaseTimeSeriesDict</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">csd_matrix_from_collection</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">other</span><span class="p">,</span>
                <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
                <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
                <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
                <span class="n">hermitian</span><span class="o">=</span><span class="n">hermitian</span><span class="p">,</span>
                <span class="n">include_diagonal</span><span class="o">=</span><span class="n">include_diagonal</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;other must be TimeSeries, TimeSeriesList/Dict, or None/&#39;self&#39;&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.coherence">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.coherence">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">coherence</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">fftlength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">overlap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">symmetric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">include_diagonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">diagonal_value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute coherence for each element or as a matrix depending on `other`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">other</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_matrix</span><span class="p">(</span>
                <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
                <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
                <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
                <span class="n">symmetric</span><span class="o">=</span><span class="n">symmetric</span><span class="p">,</span>
                <span class="n">include_diagonal</span><span class="o">=</span><span class="n">include_diagonal</span><span class="p">,</span>
                <span class="n">diagonal_value</span><span class="o">=</span><span class="n">diagonal_value</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BaseTimeSeries</span><span class="p">):</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.frequencyseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrequencySeriesList</span>

            <span class="n">new_list</span> <span class="o">=</span> <span class="n">FrequencySeriesList</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">new_list</span><span class="p">,</span>
                    <span class="n">ts</span><span class="o">.</span><span class="n">coherence</span><span class="p">(</span>
                        <span class="n">other</span><span class="p">,</span>
                        <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
                        <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
                        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">new_list</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">BaseTimeSeriesList</span><span class="p">,</span> <span class="n">BaseTimeSeriesDict</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">coherence_matrix_from_collection</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">other</span><span class="p">,</span>
                <span class="n">fftlength</span><span class="o">=</span><span class="n">fftlength</span><span class="p">,</span>
                <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
                <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
                <span class="n">symmetric</span><span class="o">=</span><span class="n">symmetric</span><span class="p">,</span>
                <span class="n">include_diagonal</span><span class="o">=</span><span class="n">include_diagonal</span><span class="p">,</span>
                <span class="n">diagonal_value</span><span class="o">=</span><span class="n">diagonal_value</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;other must be TimeSeries, TimeSeriesList/Dict, or None/&#39;self&#39;&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.impute">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.impute">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">impute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;interpolate&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">max_gap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Impute missing data (NaNs) in each TimeSeries.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        method : str, optional</span>
<span class="sd">            Imputation method (&#39;interpolate&#39;, &#39;fill&#39;, etc.).</span>
<span class="sd">        limit : int, optional</span>
<span class="sd">            Maximum number of consecutive NaNs to fill.</span>
<span class="sd">        axis : str, optional</span>
<span class="sd">            Axis to impute along.</span>
<span class="sd">        max_gap : float, optional</span>
<span class="sd">            Maximum gap size to fill (in seconds).</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Passed to TimeSeries.impute().</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TimeSeriesList</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">new_list</span><span class="p">,</span>
                <span class="n">ts</span><span class="o">.</span><span class="n">impute</span><span class="p">(</span>
                    <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">max_gap</span><span class="o">=</span><span class="n">max_gap</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.rolling_mean">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.rolling_mean">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rolling_mean</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">window</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s2">&quot;omit&quot;</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">ignore_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply rolling mean to each element.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries.rolling</span><span class="w"> </span><span class="kn">import</span> <span class="n">rolling_mean</span>

        <span class="k">return</span> <span class="n">rolling_mean</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">window</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">min_count</span><span class="o">=</span><span class="n">min_count</span><span class="p">,</span>
            <span class="n">nan_policy</span><span class="o">=</span><span class="n">nan_policy</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
            <span class="n">ignore_nan</span><span class="o">=</span><span class="n">ignore_nan</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.rolling_std">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.rolling_std">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rolling_std</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">window</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s2">&quot;omit&quot;</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">ignore_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply rolling std to each element.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries.rolling</span><span class="w"> </span><span class="kn">import</span> <span class="n">rolling_std</span>

        <span class="k">return</span> <span class="n">rolling_std</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">window</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">min_count</span><span class="o">=</span><span class="n">min_count</span><span class="p">,</span>
            <span class="n">nan_policy</span><span class="o">=</span><span class="n">nan_policy</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
            <span class="n">ddof</span><span class="o">=</span><span class="n">ddof</span><span class="p">,</span>
            <span class="n">ignore_nan</span><span class="o">=</span><span class="n">ignore_nan</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.rolling_median">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.rolling_median">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rolling_median</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">window</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s2">&quot;omit&quot;</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">ignore_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply rolling median to each element.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries.rolling</span><span class="w"> </span><span class="kn">import</span> <span class="n">rolling_median</span>

        <span class="k">return</span> <span class="n">rolling_median</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">window</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">min_count</span><span class="o">=</span><span class="n">min_count</span><span class="p">,</span>
            <span class="n">nan_policy</span><span class="o">=</span><span class="n">nan_policy</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
            <span class="n">ignore_nan</span><span class="o">=</span><span class="n">ignore_nan</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.rolling_min">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.rolling_min">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rolling_min</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">window</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s2">&quot;omit&quot;</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">ignore_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply rolling min to each element.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries.rolling</span><span class="w"> </span><span class="kn">import</span> <span class="n">rolling_min</span>

        <span class="k">return</span> <span class="n">rolling_min</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">window</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">min_count</span><span class="o">=</span><span class="n">min_count</span><span class="p">,</span>
            <span class="n">nan_policy</span><span class="o">=</span><span class="n">nan_policy</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
            <span class="n">ignore_nan</span><span class="o">=</span><span class="n">ignore_nan</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.rolling_max">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.rolling_max">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rolling_max</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">window</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s2">&quot;omit&quot;</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">ignore_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply rolling max to each element.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries.rolling</span><span class="w"> </span><span class="kn">import</span> <span class="n">rolling_max</span>

        <span class="k">return</span> <span class="n">rolling_max</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">window</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">min_count</span><span class="o">=</span><span class="n">min_count</span><span class="p">,</span>
            <span class="n">nan_policy</span><span class="o">=</span><span class="n">nan_policy</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
            <span class="n">ignore_nan</span><span class="o">=</span><span class="n">ignore_nan</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.to_matrix">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.to_matrix">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;intersection&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert list to TimeSeriesMatrix with alignment.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        align : str, optional</span>
<span class="sd">            Alignment strategy (&#39;intersection&#39;, &#39;union&#39;, etc.). Default &#39;intersection&#39;.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional arguments passed to alignment function.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TimeSeriesMatrix</span>
<span class="sd">            Matrix with all series aligned to common time axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries.matrix</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesMatrix</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.timeseries.preprocess</span><span class="w"> </span><span class="kn">import</span> <span class="n">align_timeseries_collection</span>

        <span class="n">vals</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">align_timeseries_collection</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">how</span><span class="o">=</span><span class="n">align</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># Use names from metadata (from TS objects)</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;channel_names&quot;</span><span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>

        <span class="n">matrix</span> <span class="o">=</span> <span class="n">TimeSeriesMatrix</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">names</span><span class="p">:</span>
            <span class="n">matrix</span><span class="o">.</span><span class="n">channel_names</span> <span class="o">=</span> <span class="n">names</span>
        <span class="k">return</span> <span class="n">matrix</span></div>


    <span class="c1"># ===============================</span>
    <span class="c1"># Batch Processing Methods (P1)</span>
    <span class="c1"># ===============================</span>

    <span class="c1"># --- Waveform Operations ---</span>

<div class="viewcode-block" id="TimeSeriesList.crop">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.crop">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">crop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Crop each TimeSeries in the list.</span>
<span class="sd">        Accepts any time format supported by gwexpy.time.to_gps (str, datetime, pandas, obspy, etc).</span>
<span class="sd">        Returns a new TimeSeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.time</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_gps</span>

        <span class="c1"># Convert inputs to GPS if provided</span>
        <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">to_gps</span><span class="p">(</span><span class="n">start</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">to_gps</span><span class="p">(</span><span class="n">end</span><span class="p">))</span>

        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


    <span class="c1"># def append(self, *args, **kwargs) -&gt; &quot;TimeSeriesList&quot;:</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Append to each TimeSeries in the list (in-place).</span>
    <span class="c1">#     Returns self.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     for ts in self:</span>
    <span class="c1">#         ts.append(*args, **kwargs)</span>
    <span class="c1">#     return self</span>

    <span class="c1"># def prepend(self, *args, **kwargs) -&gt; &quot;TimeSeriesList&quot;:</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Prepend to each TimeSeries in the list (in-place).</span>
    <span class="c1">#     Returns self.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     for ts in self:</span>
    <span class="c1">#         ts.prepend(*args, **kwargs)</span>
    <span class="c1">#     return self</span>

    <span class="c1"># def update(self, *args, **kwargs) -&gt; &quot;TimeSeriesList&quot;:</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Update each TimeSeries in the list (in-place).</span>
    <span class="c1">#     Returns self.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     for ts in self:</span>
    <span class="c1">#         ts.update(*args, **kwargs)</span>
    <span class="c1">#     return self</span>

<div class="viewcode-block" id="TimeSeriesList.shift">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.shift">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shift each TimeSeries in the list.</span>
<span class="sd">        Returns a new TimeSeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.gate">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.gate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">gate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gate each TimeSeries in the list.</span>
<span class="sd">        Returns a new TimeSeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">gate</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.mask">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.mask">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mask each TimeSeries in the list.</span>
<span class="sd">        Returns a new TimeSeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


    <span class="c1"># --- Signal Processing ---</span>

<div class="viewcode-block" id="TimeSeriesList.resample">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.resample">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">resample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resample each TimeSeries in the list.</span>
<span class="sd">        Returns a new TimeSeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.decimate">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.decimate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">decimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Decimate each TimeSeries in the list.</span>
<span class="sd">        Returns a new TimeSeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">decimate</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.filter">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.filter">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter each TimeSeries in the list.</span>
<span class="sd">        Returns a new TimeSeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.whiten">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.whiten">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">whiten</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whiten each TimeSeries in the list.</span>
<span class="sd">        Returns a new TimeSeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">whiten</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.notch">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.notch">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">notch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Notch filter each TimeSeries in the list.</span>
<span class="sd">        Returns a new TimeSeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">notch</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.zpk">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.zpk">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">zpk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ZPK filter each TimeSeries in the list.</span>
<span class="sd">        Returns a new TimeSeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">zpk</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.detrend">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.detrend">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">detrend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detrend each TimeSeries in the list.</span>
<span class="sd">        Returns a new TimeSeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.taper">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.taper">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">taper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Taper each TimeSeries in the list.</span>
<span class="sd">        Returns a new TimeSeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">taper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.hilbert">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.hilbert">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">hilbert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply Hilbert transform to each item.&quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">hilbert</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.envelope">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.envelope">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply envelope to each item.&quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">envelope</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.instantaneous_phase">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.instantaneous_phase">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">instantaneous_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply instantaneous_phase to each item.&quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">instantaneous_phase</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.unwrap_phase">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.unwrap_phase">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">unwrap_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply unwrap_phase to each item.&quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">unwrap_phase</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.instantaneous_frequency">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.instantaneous_frequency">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">instantaneous_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply instantaneous_frequency to each item.&quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">instantaneous_frequency</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.mix_down">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.mix_down">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">mix_down</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply mix_down to each item.&quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">mix_down</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.baseband">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.baseband">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">baseband</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply baseband to each item.&quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">baseband</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.heterodyne">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.heterodyne">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">heterodyne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply heterodyne to each item.&quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">heterodyne</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.lock_in">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.lock_in">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">lock_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply lock_in to each item.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>

        <span class="c1"># Peek first</span>
        <span class="n">first_res</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lock_in</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first_res</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">res_lists</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">first_res</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">lock_in</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
                    <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res_lists</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">val</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">res_lists</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">lock_in</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">new_list</span></div>


    <span class="c1"># --- Spectral Conversion ---</span>

<div class="viewcode-block" id="TimeSeriesList.fft">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.fft">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">fft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply FFT to each TimeSeries in the list.</span>
<span class="sd">        Returns a FrequencySeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.frequencyseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrequencySeriesList</span>

        <span class="n">new_list</span> <span class="o">=</span> <span class="n">FrequencySeriesList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.average_fft">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.average_fft">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">average_fft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply average_fft to each TimeSeries in the list.</span>
<span class="sd">        Returns a FrequencySeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.frequencyseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrequencySeriesList</span>

        <span class="n">new_list</span> <span class="o">=</span> <span class="n">FrequencySeriesList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">average_fft</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.psd">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.psd">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">psd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute PSD for each TimeSeries in the list.</span>
<span class="sd">        Returns a FrequencySeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.frequencyseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrequencySeriesList</span>

        <span class="n">new_list</span> <span class="o">=</span> <span class="n">FrequencySeriesList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.asd">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.asd">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">asd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute ASD for each TimeSeries in the list.</span>
<span class="sd">        Returns a FrequencySeriesList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.frequencyseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrequencySeriesList</span>

        <span class="n">new_list</span> <span class="o">=</span> <span class="n">FrequencySeriesList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_list</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">asd</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.spectrogram">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.spectrogram">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">spectrogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute spectrogram for each TimeSeries in the list.</span>
<span class="sd">        Returns a SpectrogramList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.spectrogram</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectrogramList</span>

        <span class="n">new_list</span> <span class="o">=</span> <span class="n">SpectrogramList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">new_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.spectrogram2">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.spectrogram2">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">spectrogram2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute spectrogram2 for each TimeSeries in the list.</span>
<span class="sd">        Returns a SpectrogramList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.spectrogram</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectrogramList</span>

        <span class="n">new_list</span> <span class="o">=</span> <span class="n">SpectrogramList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">new_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">spectrogram2</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.q_transform">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.q_transform">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">q_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute Q-transform for each TimeSeries in the list.</span>
<span class="sd">        Returns a SpectrogramList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.spectrogram</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectrogramList</span>

        <span class="n">new_list</span> <span class="o">=</span> <span class="n">SpectrogramList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">new_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">q_transform</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


    <span class="c1"># --- Statistics &amp; Measurements ---</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_scalar_or_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Internal: apply a method that can return TimeSeries or scalar.</span>
<span class="sd">        If TimeSeries -&gt; return TimeSeriesList.</span>
<span class="sd">        If scalar -&gt; return list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">TimeSeriesList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">is_ts</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">first</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">first</span><span class="p">:</span>
                <span class="n">first</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;dt&quot;</span><span class="p">):</span>
                    <span class="n">is_ts</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">is_ts</span><span class="p">:</span>
                <span class="c1"># Type check?</span>
                <span class="k">pass</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
                <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">results</span>

<div class="viewcode-block" id="TimeSeriesList.value_at">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.value_at">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">value_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get value at a specific time for each TimeSeries.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_scalar_or_map</span><span class="p">(</span><span class="s2">&quot;value_at&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.is_contiguous">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.is_contiguous">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_contiguous</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check contiguity with another object for each TimeSeries.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_scalar_or_map</span><span class="p">(</span><span class="s2">&quot;is_contiguous&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.skewness">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.skewness">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">skewness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute skewness. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">skewness</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.kurtosis">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.kurtosis">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">kurtosis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute kurtosis. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.mean">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.mean">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute mean. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.std">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.std">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">std</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute standard deviation. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.rms">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.rms">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute root-mean-square. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">rms</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.min">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.min">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute minimum. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.max">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.max">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute maximum. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.correlation">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.correlation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">correlation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute correlation. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.mic">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.mic">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">mic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute MIC. Vectorized via TimeSeriesMatrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">mic</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="c1"># --- State Analysis ---</span>

    <span class="c1"># --- Multivariate ---</span>

<div class="viewcode-block" id="TimeSeriesList.to_pandas">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.to_pandas">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert TimeSeriesList to pandas DataFrame.</span>
<span class="sd">        Each element becomes a column.</span>
<span class="sd">        ASSUMES common time axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;series_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="s2">&quot;to_pandas&quot;</span><span class="p">):</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">ts</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

            <span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.to_tmultigraph">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.to_tmultigraph">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_tmultigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to ROOT TMultiGraph.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.interop</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_tmultigraph</span>

        <span class="k">return</span> <span class="n">to_tmultigraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.write">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.write">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write TimeSeriesList to file (HDF5, ROOT, etc.).&quot;&quot;&quot;</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s2">&quot;root&quot;</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">target</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.root&quot;</span><span class="p">)):</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.interop.root_</span><span class="w"> </span><span class="kn">import</span> <span class="n">write_root_file</span>

            <span class="k">return</span> <span class="n">write_root_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">astropy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">registry</span>

        <span class="k">return</span> <span class="n">registry</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.pca">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.pca">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pca</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform PCA decomposition across channels.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.ica">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.ica">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">ica</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform ICA decomposition across channels.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">ica</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.plot">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.plot">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot all series. Delegates to gwexpy.plot.Plot.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gwexpy.plot</span><span class="w"> </span><span class="kn">import</span> <span class="n">Plot</span>

        <span class="k">return</span> <span class="n">Plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.plot_all">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.plot_all">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Alias for plot(). Plots all series.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeSeriesList.radian">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.radian">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">radian</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute instantaneous phase (in radians) of each item.&quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">new_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">radian</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>


<div class="viewcode-block" id="TimeSeriesList.degree">
<a class="viewcode-back" href="../../../api/timeseries.html#gwexpy.timeseries.TimeSeriesList.degree">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;TimeSeriesList&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute instantaneous phase (in degrees) of each item.&quot;&quot;&quot;</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">new_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_list</span></div>
</div>


    <span class="c1"># phase() and angle() are provided by PhaseMethodsMixin</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_patch_gwpy_collections</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">patches</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">BaseTimeSeriesDict</span><span class="p">,</span> <span class="n">TimeSeriesDict</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;csd_matrix&quot;</span><span class="p">,</span> <span class="s2">&quot;coherence_matrix&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">BaseTimeSeriesList</span><span class="p">,</span> <span class="n">TimeSeriesList</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;csd_matrix&quot;</span><span class="p">,</span> <span class="s2">&quot;coherence_matrix&quot;</span><span class="p">)),</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">base_cls</span><span class="p">,</span> <span class="n">impl_cls</span><span class="p">,</span> <span class="n">method_names</span> <span class="ow">in</span> <span class="n">patches</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">method_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">base_cls</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">base_cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">impl_cls</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>


<span class="n">_patch_gwpy_collections</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, gwexpy contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>