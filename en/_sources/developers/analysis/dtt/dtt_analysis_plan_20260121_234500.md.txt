# DTT解析・gwexpyへの統合要件定義 計画書 (2026-01-21 23:45:00)

この計画書は、`gwexpy/gui/reference-dtt/` に含まれるリファレンス資料を分析し、レガシーシステムである DTT (Diagnostic Test Tool) のアーキテクチャ、データ処理ロジック、UI構成を理解することで、`gwexpy` のGUIおよび解析パイプラインの開発に役立てるための手順を定義します。

## 1. 目的・目標
- DTT ソースコードから主要なアルゴリズム（FFT、伝達関数推定、励起信号生成など）を抽出する。
- ドキュメントとUIスクリーンショットから、操作モード（Excitation, Input, Measurement, Results）の仕様を整理する。
- DTT の機能と `gwexpy` の既存機能の対応マップを作成する。
- `gwexpy` が DTT を代替する上で不足している必須機能を特定する。

## 2. ロードマップ

### Phase 1: ドキュメントおよびUIの監査
- **目標**: ユーザー向け機能とシステム要件の把握。
- **タスク**:
    - `Diagnostics_Test_Software_DCC_T990013-v3.pdf` および `G000079-00.pdf` の内容要約。
    - `diaggui-GUI-Implementation-Map.md` を読み解き、現在の実装状況を確認。
    - UIスクリーンショット (`diaggui_*.png`) から、主要なインタラクティブコンポーネントを特定。

### Phase 2: コード分析 (dtt-master)
- **目標**: 基盤となる C++/Python 実装の理解。
- **タスク**:
    - `dtt-master/src/` を分析し、計算エンジン（コアロジック）を特定。
    - Python バインディングやラッパー（`scripts/`, `setup.py`）の構造をレビュー。
    - DTT が使用しているデータフォーマットおよび通信プロトコルを文書化。

### Phase 3: 統合整理とギャップ分析
- **目標**: DTT 機能を `gwexpy` の要件に変換。
- **タスク**:
    - 比較テーブルの作成: DTT 機能 vs `gwexpy` の対応クラス/メソッド。
    - 継承すべき物理・数学的仕様の特定（`check_physics` スキルを活用）。
    - 不足機能の実装計画ドラフト作成。

## 3. テスト・検証計画
- **モック実装**: `make_notebook` を使用し、`gwexpy` のデータ構造を用いた簡易的な DTT 風「測定」プロセスを再現する。
- **論理検証**: 抽出した周波数ドメイン計算ロジックがライブラリ標準と一致するか `check_physics` で確認する。

## 4. 使用モデルとリソース最適化

### 推奨モデルと選定理由
*   **モデル**: `Gemini 3 Pro (High)`
*   **理由**: PDFや画像（UIスクリーンショット）を含むマルチモーダルな情報の統合分析に加え、`dtt-master` リポジトリ全体の広範なコンテキストを扱うのに適しているため。

### リソース管理戦略
*   **コンテキスト圧縮**: 大規模な C++ ファイルの分析時には、関数のシグネチャとdocstringのみを抽出して俯瞰し、必要な箇所のみ詳細に読み込む。
*   **バッチ処理**: PDFドキュメントの要約は個別に行い、最後に統合することで、一度のトークン消費量を抑える。

## 5. 工数見積もり
*   **総工数**: 約 8〜12 時間
*   **クオータ**: High (リポジトリ全体の解析による消費)
