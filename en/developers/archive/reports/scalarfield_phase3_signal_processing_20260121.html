

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ScalarField Phase 3 Signal Processing Extensions - 実装完了レポート &mdash; gwexpy  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=9edc463e" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            gwexpy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/tutorials/index.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/en/index.html">Detailed Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/ja/index.html">詳細リファレンス</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">gwexpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">ScalarField Phase 3 Signal Processing Extensions - 実装完了レポート</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/tatsuki-washimi/gwexpy/blob/main/docs/developers/archive/reports/scalarfield_phase3_signal_processing_20260121.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="scalarfield-phase-3-signal-processing-extensions">
<h1>ScalarField Phase 3 Signal Processing Extensions - 実装完了レポート<a class="headerlink" href="#scalarfield-phase-3-signal-processing-extensions" title="Link to this heading"></a></h1>
<p><strong>日時</strong>: 2026-01-21T18:40<br />
<strong>担当</strong>: Claude Opus 4.5</p>
<hr class="docutils" />
<section id="id1">
<h2>成果物（変更ファイル）<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<section id="id2">
<h3>1. 新規作成ファイル<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ファイル</p></th>
<th class="head"><p>概要</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gwexpy/fields/demo.py</span></code></p></td>
<td><p>デモデータ生成関数（make_demo_scalar_field 等）</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gwexpy/fields/signal.py</span></code></p></td>
<td><p>信号処理コア関数（PSD, 相互相関, コヒーレンス等）</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id3">
<h3>2. 変更ファイル<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ファイル</p></th>
<th class="head"><p>変更内容</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gwexpy/fields/__init__.py</span></code></p></td>
<td><p>新規関数のエクスポート追加</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gwexpy/fields/scalar.py</span></code></p></td>
<td><p>ScalarField クラスにメソッドラッパー追加（compute_psd, freq_space_map など）</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<hr class="docutils" />
<section id="public-api">
<h2>追加・変更した Public API 一覧<a class="headerlink" href="#public-api" title="Link to this heading"></a></h2>
<section id="gwexpy-fields-demo">
<h3>デモデータ生成 (<code class="docutils literal notranslate"><span class="pre">gwexpy.fields.demo</span></code>)<a class="headerlink" href="#gwexpy-fields-demo" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>関数</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">make_demo_scalar_field(pattern,</span> <span class="pre">...)</span></code></p></td>
<td><p>決定論的デモScalarField生成（gaussian/sine/standing/noise）</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">make_propagating_gaussian(**kw)</span></code></p></td>
<td><p>伝搬ガウシアンパルス（エイリアス）</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">make_sinusoidal_wave(**kw)</span></code></p></td>
<td><p>正弦波（エイリアス）</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">make_standing_wave(**kw)</span></code></p></td>
<td><p>定在波（エイリアス）</p></td>
</tr>
</tbody>
</table>
</section>
<section id="gwexpy-fields-signal">
<h3>信号処理関数 (<code class="docutils literal notranslate"><span class="pre">gwexpy.fields.signal</span></code>)<a class="headerlink" href="#gwexpy-fields-signal" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>関数</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">compute_psd(field,</span> <span class="pre">point_or_region,</span> <span class="pre">**kwargs)</span></code></p></td>
<td><p>Welch法によるPSD計算</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">freq_space_map(field,</span> <span class="pre">axis,</span> <span class="pre">at,</span> <span class="pre">**kwargs)</span></code></p></td>
<td><p>周波数-空間マップ生成</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">compute_freq_space(...)</span></code></p></td>
<td><p>freq_space_mapの別名</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">compute_xcorr(field,</span> <span class="pre">point_a,</span> <span class="pre">point_b,</span> <span class="pre">**kwargs)</span></code></p></td>
<td><p>2点間の相互相関</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">time_delay_map(field,</span> <span class="pre">ref_point,</span> <span class="pre">plane,</span> <span class="pre">at,</span> <span class="pre">**kwargs)</span></code></p></td>
<td><p>時間遅延マップ</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">coherence_map(field,</span> <span class="pre">ref_point,</span> <span class="pre">*,</span> <span class="pre">plane,</span> <span class="pre">at,</span> <span class="pre">band,</span> <span class="pre">**kwargs)</span></code></p></td>
<td><p>コヒーレンスマップ</p></td>
</tr>
</tbody>
</table>
</section>
<section id="scalarfield">
<h3>ScalarField メソッドラッパー<a class="headerlink" href="#scalarfield" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>メソッド</p></th>
<th class="head"><p>説明</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">field.compute_psd(point_or_region,</span> <span class="pre">**kwargs)</span></code></p></td>
<td><p>compute_psdのラッパー</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">field.freq_space_map(axis,</span> <span class="pre">at,</span> <span class="pre">**kwargs)</span></code></p></td>
<td><p>freq_space_mapのラッパー</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">field.compute_xcorr(point_a,</span> <span class="pre">point_b,</span> <span class="pre">**kwargs)</span></code></p></td>
<td><p>compute_xcorrのラッパー</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">field.time_delay_map(ref_point,</span> <span class="pre">plane,</span> <span class="pre">at,</span> <span class="pre">**kwargs)</span></code></p></td>
<td><p>time_delay_mapのラッパー</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">field.coherence_map(ref_point,</span> <span class="pre">plane,</span> <span class="pre">at,</span> <span class="pre">**kwargs)</span></code></p></td>
<td><p>coherence_mapのラッパー</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<hr class="docutils" />
<section id="docstring">
<h2>主要関数の docstring（抜粋）<a class="headerlink" href="#docstring" title="Link to this heading"></a></h2>
<section id="compute-psd">
<h3>compute_psd<a class="headerlink" href="#compute-psd" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_psd</span><span class="p">(</span>
    <span class="n">field</span><span class="p">:</span> <span class="n">ScalarField</span><span class="p">,</span>
    <span class="n">point_or_region</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">nperseg</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">noverlap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
    <span class="n">detrend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
    <span class="n">scaling</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="s2">&quot;spectrum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;density&quot;</span><span class="p">,</span>
    <span class="n">average</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;median&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="n">return_onesided</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FrequencySeries</span> <span class="o">|</span> <span class="n">FrequencySeriesList</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute power spectral density using Welch&#39;s method.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    FrequencySeries or FrequencySeriesList</span>
<span class="sd">        - 単一点: FrequencySeries（Unit: field.unit² / Hz）</span>
<span class="sd">        - 複数点: FrequencySeriesList</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        時間軸が不規則、または axis0_domain != &#39;time&#39; の場合。</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="freq-space-map">
<h3>freq_space_map<a class="headerlink" href="#freq-space-map" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">freq_space_map</span><span class="p">(</span>
    <span class="n">field</span><span class="p">:</span> <span class="n">ScalarField</span><span class="p">,</span>
    <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">at</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;welch&quot;</span><span class="p">,</span> <span class="s2">&quot;fft&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;welch&quot;</span><span class="p">,</span>
    <span class="o">...</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScalarField</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute frequency-space map along a spatial axis.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ScalarField</span>
<span class="sd">        Shape: (n_freq, n_x, 1, 1) など。axis0_domain=&#39;frequency&#39;。</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="compute-xcorr">
<h3>compute_xcorr<a class="headerlink" href="#compute-xcorr" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_xcorr</span><span class="p">(</span>
    <span class="n">field</span><span class="p">:</span> <span class="n">ScalarField</span><span class="p">,</span>
    <span class="n">point_a</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
    <span class="n">point_b</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">max_lag</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;full&quot;</span><span class="p">,</span> <span class="s2">&quot;same&quot;</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;full&quot;</span><span class="p">,</span>
    <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">detrend</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeSeries</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute cross-correlation between two spatial points.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    TimeSeries</span>
<span class="sd">        ラグ軸を持つ相互相関関数。正のラグは point_b が point_a に先行することを示す。</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="time-delay-map">
<h3>time_delay_map<a class="headerlink" href="#time-delay-map" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">time_delay_map</span><span class="p">(</span>
    <span class="n">field</span><span class="p">:</span> <span class="n">ScalarField</span><span class="p">,</span>
    <span class="n">ref_point</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
    <span class="n">plane</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;xy&quot;</span><span class="p">,</span>
    <span class="n">at</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">max_lag</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">stride</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">roi</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">detrend</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScalarField</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute time delay map from a reference point.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ScalarField</span>
<span class="sd">        遅延値を保持するスライス。Unit は時間単位（例: s）。</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="coherence-map">
<h3>coherence_map<a class="headerlink" href="#coherence-map" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">coherence_map</span><span class="p">(</span>
    <span class="n">field</span><span class="p">:</span> <span class="n">ScalarField</span><span class="p">,</span>
    <span class="n">ref_point</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>  <span class="c1"># 注意: plane, atはキーワード専用</span>
    <span class="n">plane</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;xy&quot;</span><span class="p">,</span>
    <span class="n">at</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">band</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">nperseg</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">noverlap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
    <span class="n">stride</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ScalarField</span> <span class="o">|</span> <span class="n">FieldDict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute magnitude-squared coherence map from a reference point.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ScalarField or FieldDict</span>
<span class="sd">        - band指定時: スカラーコヒーレンス値の ScalarField</span>
<span class="sd">        - band=None: 周波数軸を持つ ScalarField</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id4">
<h2>テスト担当へ渡す「テスト観点」メモ<a class="headerlink" href="#id4" title="Link to this heading"></a></h2>
<section id="demo-py">
<h3>1. デモデータ生成 (<code class="docutils literal notranslate"><span class="pre">demo.py</span></code>)<a class="headerlink" href="#demo-py" title="Link to this heading"></a></h3>
<section id="id5">
<h4>機能テスト<a class="headerlink" href="#id5" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] <code class="docutils literal notranslate"><span class="pre">make_demo_scalar_field</span></code> の全パターン（’gaussian’, ‘sine’, ‘standing’, ‘noise’）が正常に生成される</p></li>
<li><p>[ ] seed を固定した場合、同じデータが再生成される（決定論性）</p></li>
<li><p>[ ] 軸メタデータ（times, x, y, z）が正しい単位を持つ</p></li>
<li><p>[ ] <code class="docutils literal notranslate"><span class="pre">axis0_domain='time'</span></code>、<code class="docutils literal notranslate"><span class="pre">space_domain='real'</span></code> が設定される</p></li>
</ul>
</section>
<section id="id6">
<h4>エッジケース<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] nt=1, nx=1 など最小サイズでエラーにならない</p></li>
<li><p>[ ] 非常に大きなサイズ（nt=1000, nx=64）でメモリエラーにならない</p></li>
</ul>
</section>
</section>
<section id="id7">
<h3>2. compute_psd<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<section id="id8">
<h4>正常系<a class="headerlink" href="#id8" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] 単一点指定で FrequencySeries が返る</p></li>
<li><p>[ ] 複数点指定で FrequencySeriesList が返る</p></li>
<li><p>[ ] region（dict）指定で平均化された PSD が返る</p></li>
<li><p>[ ] 周波数軸の単位が正しい（例: 1/s = Hz）</p></li>
<li><p>[ ] PSD 単位が正しい（density: unit²/Hz, spectrum: unit²）</p></li>
</ul>
</section>
<section id="id9">
<h4>合成信号検証<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] 既知周波数の正弦波で、PSD ピークがその周波数に現れる</p></li>
<li><p>[ ] ホワイトノイズで PSD が概ねフラット</p></li>
</ul>
</section>
<section id="id10">
<h4>エラー系<a class="headerlink" href="#id10" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] <code class="docutils literal notranslate"><span class="pre">axis0_domain='frequency'</span></code> でエラー</p></li>
<li><p>[ ] 不規則時間軸（irregular）でエラー</p></li>
<li><p>[ ] 時間軸長 &lt; 2 でエラー</p></li>
</ul>
</section>
</section>
<section id="id11">
<h3>3. freq_space_map<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<section id="id12">
<h4>正常系<a class="headerlink" href="#id12" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] 返り値が ScalarField で axis0_domain=’frequency’</p></li>
<li><p>[ ] shape が (n_freq, n_x, 1, 1) など期待どおり</p></li>
<li><p>[ ] at 指定なしでも length=1 軸は自動使用</p></li>
</ul>
</section>
<section id="id13">
<h4>エラー系<a class="headerlink" href="#id13" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] 軸 length &gt; 1 で at 未指定時にエラー</p></li>
</ul>
</section>
</section>
<section id="id14">
<h3>4. compute_xcorr<a class="headerlink" href="#id14" title="Link to this heading"></a></h3>
<section id="id15">
<h4>正常系<a class="headerlink" href="#id15" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] 返り値が TimeSeries</p></li>
<li><p>[ ] normalize=True で値が [-1, 1] 範囲</p></li>
<li><p>[ ] max_lag による切り詰めが動作する</p></li>
<li><p>[ ] mode=’full’/’same’/’valid’ で出力長が変わる</p></li>
</ul>
</section>
<section id="id16">
<h4>合成信号検証<a class="headerlink" href="#id16" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] 既知のシフトを持つ信号で、ピークラグがシフト値と一致</p></li>
</ul>
</section>
</section>
<section id="id17">
<h3>5. time_delay_map<a class="headerlink" href="#id17" title="Link to this heading"></a></h3>
<section id="id18">
<h4>正常系<a class="headerlink" href="#id18" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] 返り値が ScalarField</p></li>
<li><p>[ ] 遅延値の単位が時間単位（s など）</p></li>
<li><p>[ ] stride によりサブサンプリングされた shape</p></li>
</ul>
</section>
<section id="id19">
<h4>合成信号検証<a class="headerlink" href="#id19" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] 伝搬波形で、遅延マップが距離に比例して変化</p></li>
</ul>
</section>
<section id="id20">
<h4>パフォーマンス<a class="headerlink" href="#id20" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] stride, roi 指定で計算量が減少</p></li>
</ul>
</section>
</section>
<section id="id21">
<h3>6. coherence_map<a class="headerlink" href="#id21" title="Link to this heading"></a></h3>
<section id="id22">
<h4>正常系<a class="headerlink" href="#id22" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] band 指定時: スカラー ScalarField（shape に time 軸が 1）</p></li>
<li><p>[ ] band=None 時: 周波数軸付き ScalarField（axis0_domain=’frequency’）</p></li>
<li><p>[ ] コヒーレンス値が [0, 1] 範囲</p></li>
</ul>
</section>
<section id="id23">
<h4>合成信号検証<a class="headerlink" href="#id23" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] 同一信号の自己コヒーレンスが 1.0</p></li>
<li><p>[ ] 無相関なノイズ間のコヒーレンスが ≈ 0</p></li>
</ul>
</section>
<section id="id24">
<h4>エラー系<a class="headerlink" href="#id24" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] band が周波数範囲外で ValueError</p></li>
</ul>
</section>
</section>
<section id="id25">
<h3>7. 共通<a class="headerlink" href="#id25" title="Link to this heading"></a></h3>
<section id="id26">
<h4>単位整合性<a class="headerlink" href="#id26" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] 入力 ScalarField の単位が出力に正しく反映される</p></li>
<li><p>[ ] 軸座標の単位変換（m→km など）が正常</p></li>
</ul>
</section>
<section id="d-shape">
<h4>4D shape 保持<a class="headerlink" href="#d-shape" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>[ ] 返り値 ScalarField が常に 4 次元</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section id="id27">
<h2>今後の拡張ポイント（参考）<a class="headerlink" href="#id27" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>描画ラッパー</strong>: <code class="docutils literal notranslate"><span class="pre">plot_psd</span></code>, <code class="docutils literal notranslate"><span class="pre">plot_freq_space</span></code>, <code class="docutils literal notranslate"><span class="pre">plot_xcorr</span></code>, <code class="docutils literal notranslate"><span class="pre">plot_delay_map</span></code>, <code class="docutils literal notranslate"><span class="pre">plot_coherence_map</span></code></p></li>
<li><p><strong>GPU/並列化</strong>: <code class="docutils literal notranslate"><span class="pre">time_delay_map</span></code>, <code class="docutils literal notranslate"><span class="pre">coherence_map</span></code> の numpy 演算を vectorize</p></li>
<li><p><strong>非等間隔時間軸対応</strong>: Lomb-Scargle 法への切り替え</p></li>
</ol>
<hr class="docutils" />
<p><em>End of Report</em></p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, gwexpy contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>